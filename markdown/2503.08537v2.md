Chemical reasoning in LLMs unlocks
strategy-aware synthesis planning and reaction
mechanism elucidation

Andres M Bran1,2*, Th´eo A. Neukomm1, Daniel Armstrong1,
Zlatko Jonˇcev1, Philippe Schwaller1,2*
1 ´Ecole Polytechnique F´ed´erale de Lausanne (EPFL), Rte Cantonale,
Lausanne, 1015, Switzerland.
2National Centre of Competence in Research (NCCR) Catalysis,
Switzerland.

*Corresponding author(s). E-mail(s): andres.marulandabran@epﬂ.ch;
philippe.schwaller.epﬂ.ch;
Contributing authors: theo.neukomm@epﬂ.ch; daniel.armstrong@epﬂ.ch;
zlatko.joncev@epﬂ.ch;

Abstract

While automated chemical tools excel at speciﬁc tasks, they have struggled
to capture the strategic thinking that characterizes expert chemical reasoning.
Here we demonstrate that large language models (LLMs) can serve as power-
ful tools enabling chemical analysis. When integrated with traditional search
algorithms, they enable a new approach to computer-aided synthesis that mir-
rors human expert thinking. Rather than using LLMs to directly manipulate
chemical structures, we leverage their ability to evaluate chemical strategies and
guide search algorithms toward chemically meaningful solutions. We demonstrate
this paradigm through two fundamental challenges: strategy-aware retrosynthetic
planning and mechanism elucidation. In retrosynthetic planning, our system
allows chemists to specify desired synthetic strategies in natural language – from
protecting group strategies to global feasibility assessment – and uses traditional
or LLM-guided Monte Carlo Tree Search to ﬁnd routes that satisfy these con-
straints. In mechanism elucidation, LLMs guide the search for plausible reaction
mechanisms by combining chemical principles with systematic exploration. This
approach shows strong performance across diverse chemical tasks, with newer
and larger models demonstrating increasingly sophisticated chemical reasoning.
Our approach establishes a new paradigm for computer-aided chemistry that

1

5
2
0
2

l
u
J

3
2

]
I

A
.
s
c
[

2
v
7
3
5
8
0
.
3
0
5
2
:
v
i
X
r
a

combines the strategic understanding of LLMs with the precision of traditional
chemical tools, opening possibilities for more intuitive and powerful chemical
automation systems.

Keywords: chemical reasoning, large language models, synthesis planning, reaction
mechanisms

1 Main

The automation of chemical reasoning has been a long-standing goal in many areas of
chemistry, promising to accelerate drug discovery, retrosynthesis[1–3] and our under-
standing of chemical reactivity [4]. Traditional machine learning and computational
approaches have focused on specialized algorithms for speciﬁc tasks – predicting prop-
erties [5], planning syntheses [1, 6], or proposing reaction mechanisms [7–14]. While
successful in narrow domains, these systems lack the ﬂexible reasoning and strate-
gic multi-step thinking that characterize expert chemical problem-solving [15–17]. A
synthetic chemist planning the synthesis of a complex molecule, for instance, must
simultaneously consider multiple strategic factors: which rings to form ﬁrst, when to
install sensitive functional groups and protective groups, and how to leverage avail-
able starting materials [18]. Additionally, this logical deconstruction of molecules must
be supported by mechanistic reasoning which requires extrapolation of chemical prin-
ciples of elementary steps and reactive intermediates, to newly proposed molecules,
usually not observed before [4, 19].

The exponential growth in capabilities of Large Language Models (LLMs) has
sparked a revolution across scientiﬁc disciplines [3, 20–22], with applications spanning
from automated literature analysis to hypothesis generation [23–25]. These models
have demonstrated an unprecedented ability to understand and reason about chemical
concepts - from individual functional groups to complete synthetic pathways [3, 26,
27]. Most remarkably, they exhibit reasoning patterns that mirror human chemical
intuition rather than traditional computational approaches [21, 28], showing particular
promise in analyzing strategic elements of synthesis such as protecting group patterns
and ring construction timing [18]. However, a fundamental limitation persists: while
LLMs excel at analyzing chemical concepts and strategies, they struggle to generate
valid chemical representations, particularly SMILES strings [29–31], limiting their
direct application in critical chemical tasks.

Here, we present a paradigm shift in how LLMs can advance chemical science:
rather than attempting to generate chemical structures directly, we position these
models as sophisticated reasoning engines that guide traditional search algorithms
toward chemically meaningful solutions. This approach combines LLMs’ ability to
understand and evaluate complex chemical strategies with the systematic exploration
capabilities of established search methods. Through systematic evaluation, we ﬁrst
demonstrate that LLMs can eﬀectively analyze chemical entities and strategic pat-
terns across multiple scales. We then show how these reasoning capabilities can be

2

exploited in two challenging applications: strategy-aware retrosynthetic planning and
mechanism elucidation.

Retrosynthetic planning —the process of systematically breaking down complex
target molecules into simpler, commercially available starting materials— represents
one of the most crucial and intellectually demanding tasks in organic chemistry [1, 32].
Current computational methods employ sophisticated search algorithms guided by
either carefully designed or learned heuristics [33–35]. While these systems excel at
ﬁnding routes that end in commercially available materials [36, 37], they often strug-
gle to incorporate strategic considerations commonly used by expert chemists, such as
optimal timing for ring construction, protecting group introduction or incompatible
transformations [18]. Recent specialized systems have addressed speciﬁc constraints
like starting material availability [38, 39] and bond preservation [40, 41], but a
framework for arbitrary strategy-aware synthesis planning has remained elusive. Our
approach allows chemists to specify strategic requirements in natural language, with
LLM-guided search identifying synthetic routes that satisfy these complex constraints.
We demonstrate these capabilities on a challenging benchmark, along with a case
study targeting global feasibility analysis and ranking of synthetic routes from multiple
sources, including experimentally validated routes.

Similarly, mechanism elucidation —understanding the step-by-step electron move-
ments that transform reactants into products— is fundamental to both chemical
understanding and reaction optimization [4, 19, 42]. The power of mechanistic under-
standing lies not only in explaining individual reactions but in their potential to
generalize patterns of chemical reactivity that can be applied to previously unseen
molecules [43]. Existing computational methods can enumerate possible reaction paths
[7, 44] but often lack the chemical intuition needed to identify plausible mechanisms.
While specialized approaches combining quantum calculations with search algorithms
show promise [10], they struggle to scale for complex systems and rely on prede-
ﬁned templates or atom-mapping, limiting their applicability. In our approach, basic
electron-pushing steps are evaluated using LLMs’ understanding of chemical principles
in the context of a search algorithm, allowing the LLM to guide the search towards
reasonable mechanisms, while potentially considering diverse forms of experimental
evidence and practical constraints. Our results demonstrate that LLMs can eﬀec-
tively guide search processes and select optimal solutions, while providing chemically
meaningful rationales for their decisions. Furthermore, we provide insights into how
diﬀerent models’ capabilities —related to pretraining [45], post-training [28, 46, 47]
and inference-time scaling [28, 48]— aﬀect solution quality, establishing crucial practi-
cal considerations for deploying such systems. This integration represents a signiﬁcant
step toward computational chemistry systems that can reason strategically about com-
plex synthesis challenges while maintaining the precision of traditional computational
tools.

2 Results

The approach presented here leverages LLMs as chemical reasoning engines that guide
traditional search algorithms through complex chemical spaces. Here, a rule-based

3

a

State of LLMs in Chemistry

Chemical
research
tasks

Prompting
& in-context
learning

Strengths

Weaknesses

¥ Property prediction (Jablonka, 2024)
¥ Multiple choice questions (Mirza, 2024)
¥ Agentic workflow (Boiko, 2023; Bran, 2024)

All chemistry-speci(cid:222)c generative tasks,
due to invalid SMILES (Christo(cid:222)dellis, 2022)
and lack of diversity (Jang, 2024).

General-purpose LLMs

c Enable global strategic analysis

b

Discovery: Latest LLMs reason about
chemistry

OH

OH

H2N

N

N

N

N

N

O

H
N

N

Boc

N

N

N

N

O

<analysis>
Protection reaction,
speciﬁcally an amine to
carbamate conversion
using a Boc protection.
</analysis>

<mechanism>
ç Nucleophilic attack of the
primary amine on the Boc
anhydride […]
ç Elimination of tert-

butoxide leaving group […]

</mechanism>

d LLM as chemical reasoning engines

LLM analysis

¥ Amide bond
formation (#3) can
proceed selectively,
no need for PG.
¥ Ring closure (#2)
does not require PG
on -COOH. 5-ring
formation favored
(kinetic, enthropic
advantage).

Me

F

N

O

H
N

OH

O

N
H

Cl

N

HN

O

O

F

Me

#1

F

N

N

HN

O

H
N

O

O

#2

Me

O

F

Me

Cl

Me

O

F

Me

Cl

O

N
H

O

N
H

Me

#4

H2N

O

O

H2N

NH2

Me

O

O

NH

F

O

Cl

F

#3

Me

N

N
H

NH2

O

O

H
N

Expert query

¥ Reactions
¥ Disconnections
¥ Strategic patterns
¥ Starting materials
¥ Desired conditions

Traditional
search
algorithm

Feature
satisfying
query

LLM-guided solutions

The route shows excellent
alignment with the query for
several reasons: [(cid:201)]
<score>9</score>

e Application: Steerable synthesis planning
Top-ranked synthetic route

Expert query:
Break pyrimidine in the early
stage but get all other rings
from commercially available
materials.

H

N

N

N

N

N

Me

N

N

O

15 steps

N

Me

Me

OH

Me

N

N

N

Br

NH2

¥ Natural language
¥ Full route analysis
¥ Route selection

Br

N

HO

N

N

N

NH

O

H2N

N

OHC

NH

O

Query
satis(cid:222)ed

Wee1 kinase inhibitor by Merck

f Application: Reaction mechanism elucidation

Proposed mechanism

Me

Chemical
reasoning LLM

LLM score: x/10

Input:
Me

O

O

Me

+ NH3

Me

Me

O

H2N

OH

C+

O-

O

Me

+
NH3

Me

Me

...

O O-

NH3
+

Me

Me

O

H2N

OH

Me

O

O

Me

H+

+
-
NH2

...

...

...

• 196  nodes
• 228 LLM Calls

LLM-guided search
consistently ﬁnds the
correct solution.

Fig. 1 LLMs as chemical reasoning engines for synthesis planning and mechanism eluci-
dation. a) Current state of LLMs in chemistry, highlighting strengths in property prediction, multiple
choice questions, and agentic workﬂows, alongside limitations in structure generation tasks. b) LLMs
demonstrate sophisticated chemical reasoning capabilities, providing detailed analyses of reaction
mechanisms and functional group transformations. c) Analytical capabilities go beyond single reac-
tions, being able to analyze a route in global terms. LLMs are capable of detecting when protecting
groups are unnecessarily proposed as part of a synthetic route. d) Our key insight: positioning LLMs
as strategic evaluators within chemical search frameworks. Rather than generating structures directly,
LLMs guide traditional search algorithms toward chemically meaningful solutions. e) Application
to synthesis planning: LLMs assess candidate routes based on guidance queries specifying strategic
requirements (e.g., ”break pyrimidine in the early stage”). This yields strategically relevant synthetic
pathways with detailed rationales for synthetic choices. f) Application to mechanism elucidation:
LLMs guide search through possible reaction mechanisms by evaluating the plausibility of elementary
electron-pushing steps. The system eﬃciently identiﬁes correct mechanistic pathways while providing
chemically meaningful justiﬁcations. This approach combines the strategic understanding of LLMs
with the precision of traditional chemical search algorithms.

process is in charge of generating and proposing intermediate states, while the LLM
serves as a judge to select among possible solution paths. The following results and
our analyses show that current LLMs are capable of detailed analysis of relevant
chemical objects like molecules, reactions, and reactive intermediates. Furthermore,
we demonstrate how these capabilities can be leveraged in novel and useful manners
for scientiﬁc discovery in synthetic chemistry through two challenging applications:

4

prompt-guided and strategy-aware retrosynthetic planning, where natural language
queries guide the search for synthetic routes with speciﬁc properties, and mechanism
elucidation, where the goal is to identify plausible reaction mechanisms by evaluating
candidate electron-pushing steps.

2.1 Strategy-aware Synthesis Planning

Retrosynthetic planning represents one of the most challenging tasks in organic
chemistry, requiring both deep chemical knowledge and strategic thinking. While
computational approaches have successfully automated the search through spaces of
reactions, they typically struggle to incorporate the strategic elements that enable
synthesis. The complexity of the task arises from multiple challenges across multi-
ple levels and dimensions. At the reaction level, chemists must select transformations
that are high-yielding, selective, and technically feasible. At a more global level, long-
range considerations make the task almost an art: early synthetic decisions constrain
later structural possibilities, protecting groups and functional group interconversions
unlock otherwise impossible transformations, and these interconnected choices cre-
ate intricate decision trees spanning entire synthetic routes. Expert chemists develop
sophisticated heuristics for navigating these strategic elements. However, translating
this expertise into computational systems has remained challenging.

Here, we extend traditional computer-assisted retrosynthetic search by incorporat-
ing natural language speciﬁcations of desired synthetic strategies. Given a molecular
target and a description of desired route characteristics (e.g. ”construct the pyrimidine
ring in early stages”), the system must identify synthetic pathways that satisfy these
strategic constraints, see Figure 1e. Such a task requires not only correct understand-
ing of molecular and reaction representations but also an ability to connect chemical
theory with practical experimental considerations and modern synthetic methods,
depending on the query.

Considering the robust analytical capabilities demonstrated by LLMs (see Figure
1a-c, we developed Synthegy: a framework that combines these analytical capabilities
with traditional synthesis planning software (Methods 4.2). For evaluation, we cre-
ated a benchmark consisting of pairs of molecular targets and prompts, along with
scoring scripts that assess route-to-prompt alignment in a tailored manner (Methods
4.4). These prompts specify features of the target synthetic route, and range from
simple reaction preferences to complex strategic requirements, allowing us to assess
the chemical reasoning capabilities of diﬀerent LLMs and their ability to eﬀectively
guide synthesis planning, see SI-??.

Results in Figure 2a show that current commercial LLMs can already perform
advanced reasoning about synthetic routes, successfully evaluating both speciﬁc reac-
tions and global strategic features. Large, state-of-the-art models like Gemini-2.5-pro
achieve the highest scores. This model achieves such performance by systematically
analyzing each reaction in the synthetic sequence, while keeping track of the overall
synthetic context, then correlating this with the given prompt (Figure 2b). Our results
additionally show that the newer generation of models bring substantial improve-
ments over older generations, with the newest Gemini-2.5-pro performing much better

5

on the harder tasks (Target 4), where no other model could succeed. Figure 2c fur-
ther highlights the rapid progress that is being achieved thanks to advancements in
LLM capability. The plot shows that the kind of intelligence required to tackle the
challenge of strategy-aware synthesis planning was entirely missing until around June
2024 with the release of Claude-3.5-Sonnet, which achieves an important improvement
in capability relative to any other model at the time. More recently, gemini-2.5-pro
established a new state of the art by improving over 50% relative to the next best
model. Notably, an open model like DeepSeek-r1 achieves high performances as well,
positioning it as a strong open and local alternative to closed providers.

Performance scales strongly with model size. Smaller models’ performance is indis-
tinguishable from random choice even for short routes (see SI-??), suggesting that
the chemical reasoning capabilities required for this task emerge only at larger scales.
This suggests either a minimum threshold of model complexity required for meaning-
ful chemical analysis, or a limitation in the multi-task performance of smaller models,
suggesting that ﬁne-tuning and other post-processing techniques might be needed
to leverage small models on these tasks. Models from other providers (OpenAI [49],
DeepSeek [50]) show comparable performance patterns to Claude, with variations
potentially attributable to diﬀerences in tokenization and prompting strategies rather
than fundamental capability gaps.

A key limitation is observed across all models when tackling long synthetic
sequences. For the most complex targets (e.g. Target 4, involving routes up to 50 reac-
tions), all models struggle to distinguish and select aligned routes, with the exception
of the latest Gemini-2.5-pro [51], which demonstrates unprecedented performance in
our benchmark, while producing highly reliable and faithful reasoning traces that
enable explainability of the results, see SI-?? for examples. Despite these impressive
results, some erroneous outputs are still observed. Common failure modes observed
across diﬀerent LLMs include grouping reactions instead of analyzing them individu-
ally, which causes overlooking of important ﬁne details, and failing to correctly position
individual reactions in the context of a large route. Still, LLMs show overall posi-
tive correlations in these extreme cases, showing that some relevant features of routes
are still recovered by LLMs, making them useful even for the most complex routes,
suggesting their utility as strategic evaluators.

These results demonstrate that current LLMs can eﬀectively assess synthesis plan-
ning through analysis and evaluation of arbitrary strategic elements in synthetic
routes. In the sections following, we further analyze and validate these ﬁndings against
real-world chemistry and use-cases, where alternative methodologies can hardly be
applied. In particular, we focus on global assessments of feasibility. Under the Syn-
thegy framework, this corresponds to steering towards –or selecting– routes that are
overall more feasible, or that are likely to lead to the product in overall high yields.

2.2 Assessing Feasibility of Synthetic Routes

The examples demonstrated in Section 2.1 show the power of Synthegy for selecting
synthesis solutions as described in a prompt. The examples shown so far are veriﬁable
by tailored cheminformatics code, thus making their value mostly demonstrative and
evaluative, due to the possibility of deﬁning ground truth answers. To test the limits of

6

a  Performance in steerable synthesis planning

Molecular Weight of Target

s
e
r
o
c
S
T
G
h

t
i

w
s
k
n
a
r

f

o

.
r
r
o
C

mean

Target 1

Target 2

Target 3

Target 4

b   High-ranked route example (search + expert natural language query)

Me

F

N

O

OH

O

F

NH

N

NH

O

O

NH

Cl

Step 1-3

Me

Me

F

N

O

OEt

Step 4

NH

N

NH

O

O

Boc

N

H

Me

F

N

O

OEt

Step 5

NH

NH

NH2

O

Boc

N

H

Me

F

N

OH

NH

NH2

NH2

O

O

OEt

Boc

N

H

Expert query: Early imidazole ring formation.

LLM analysis (step 4)

c  Evolution of LLM performance
over time.

This is the critical imidazole ring-forming step. The reaction converts a 2-
aminopyridine intermediate into an imidazo[4,5-b]pyridine ring system
using a carbonyl equivalent (trichloromethyl carbonate derivative).
This  is  the  key  cyclization  that  forms  the  desired  heterocycle,  and
importantly, it occurs relatively early in the synthesis, aligning well with the
query’s requirement.

The proposed synthetic route strongly aligns with the query’s requirement
for early imidazole ring formation [(cid:201)] <score>9/10</score>

LLM analysis (overall)

d  Fine-grained chemical reasoning (molecular glue degrader, Novartis)

Expert query:
Break piperidine and
oxoisoindolinone rings
in the synthesis. Get
the piperidine-2,6-
dione from
commercially available
materials.

Target molecule

Proposed routes

O

N

Et

O

N

O

NH

O

3 steps

HO

Br

HN

Et

OH

H2N

O

NH

O

O

Br

Br

Score
7/10

Score
3/10

Br

HO

N

Et

H2 N

O

NH

O

O

Query not satisﬁed

2 steps

Query satisﬁed

e
r
o
c
s

k
r
a
m
h
c
n
e
B

Fig. 2 Performance of the system for strategy-aware synthesis planning presented in this work. a
Performance of multiple LLMs of diﬀerent sizes and providers across all the tasks in the benchmark.
The tasks are grouped by synthetic target, and each column speciﬁes a prompt as speciﬁed in SI-??.
The y axis displays the correlation between LLM-produced scores and those computed as speciﬁed in
the benchmark. Each data point represents a separate execution of the benchmark, with the number
of repetitions (n) varying across LLMs based on execution time and resource constraints as speciﬁed
in the legend. Error bars denote conﬁdence intervals (95%). b Example of an LLM’s analysis of
a synthetic route, where it provides a justiﬁcation why a speciﬁc route received a high score. The
example illustrates that the LLM analyses each reaction (exempliﬁed with step 4), and then provides
an overall analysis where it highlights the alignment with the user’s query. c Average performance of
multiple LLMs over time. Shown are only models that are the state of the art for their time, or close
to it. The plot illustrates the rapidly evolving advancements in capability. d Illustrates the task of
strategy-aware synthesis planning: a user speciﬁes a target molecule along with a query in natural
language, which speciﬁes desired features in the route. The proposed solutions are given together
with scores that signify their alignment with the query given by the user.

LLM capability on Synthegy —beyond what current alternative tools allow— we now

7

use the same framework to attempt to select more feasible synthetic routes. Feasibil-
ity involves assessing several factors and their interplay: prediction of side-products,
hypothesizing and evaluating reaction conditions, feasibility of speciﬁc reaction types,
functional group incompatibilities, etc. Beyond that, the strategic feasibility of a syn-
thetic route also plays an important role in this regard, as unnecessary reactions can
severely hinder overall yields and compromise scalability.

With the same framework as introduced in the previous section, we use the

following prompt to ﬁnd feasible synthetic routes for the targets 1 to 4, see SI-??.

Feasibility prompt

Highly feasible synthesis with high overall yields, consider potential side
reactions and byproducts. Also ensure no unnecessary reactions are performed.

We furthermore evaluate the feasibility of routes obtained through 3 diﬀerent ret-
rosynthesis engines: AIZynth [16], Reaxys [52], and SynthiaTM [53] (see Methods 4.3).
To compare these results against experimentally-validated routes, we also evaluate the
original routes for these molecules as disclosed in their respective publications [54–56].
All the results presented here were computed using Gemini-2.5-pro [51] as a backend
LLM as it demonstrated the best performance in our evaluations (see Section 2.1).

For Reaxys and SynthiaTM, we used the default preset settings, with routes
restricted to the top-25 pathways out of the 50 generated ones for the latter. Those
retrosynthesis engines can be further customized to user requirements, which would
potentially lead to better results. For instance, SynthiaTM can be ﬁne-tuned according
to chemical preferences, such as using robust chemistry and avoiding gaseous reac-
tants or metal catalysis. Promoting more common reaction classes could better align
with our score, as common reactions are classiﬁed as more feasible in our approach.
The results in Figure 3a indicate a general bias towards generally infeasible routes
in the case of AiZynth, with some small amount of these receiving high scores and thus
being deemed feasible. The LLM justiﬁes these low scores with several types of ﬂaws,
including ill-conceived protection strategies, reactions with low chances of success, and
global strategic ﬂaws such as unnecessary protection cycles and inappropriate ordering
of reactions, see SI-?? for more details. Generally, the commercial tools perform the
best as they tend to propose highly feasible solutions in most cases, and in all cases
at least one highly feasible route.

Evaluation of the original synthetic routes devised for these targets [54–56] provide
experimental validation of the power of Synthegy at assessing the feasibility of syn-
thetic routes, as these routes were designed by expert chemists and actually executed
in a lab, in enough quantities as to allow the evaluation of drug-relevant properties. As
shown in Figure 3a, the experimentally realized routes obtain generally high scores,
thus providing experimental evidence of the predictive power enabled by Synthegy.
Interestingly, results for Target 2 show a general bias towards low scores, even for the
experimentally evaluated route, however all tools provide at least one route scoring
much higher than the experimentally validated one. Low scores for the experimental

8

a Feasibiliy assessment for routes generated with different retrosynthesis software.

b Example of a feasible route found by Synthegy
N

O

Synthegy Score:
9/10

O

O

NH

N

O

Reaction 1

#1

F

N

+

OH

O

N

O

NH

O

#2

NH

+

OH

Cl

Reaction 2

The SNAr reaction on an activated aryl fluoride is a
robust and widely used method in medicinal
chemistry for C-O bond formation. Known to be highly
feasible and generally proceeds in high yields (>80%).

Highly feasible, well-established. The primary alcohol
on the reactant is a much weaker nucleophile than the
secondary amine and is generally unreactive. O-
alkylation is a negligible side reaction.

Modern, ef(cid:222)cient, and robust approach to synthesizing the target. The choice of a convergent strategy using
powerful C-N and C-O bond-forming reactions is excellent. It directly addresses all aspects of the query:
high yields are expected, side reactions are minimal and manageable, and the synthesis is concise.

Overall Assessment

c Route deemed unfeasible by Synthegy

Synthegy Score:
2/10

N

O

#1

N

O

#2

N

O

Br
HN

O

O

NH

O

N

O

NH

O

Reaction 2

Substrate contains also a glutarimide. Strong
reducing agents will readily reduce imide, likely
opening the ring [(cid:201)] This will lead to a mixture of
byproducts and a very low yield of desired product.

NH

I

+

OH

#6

Br

NH

O

Br

Br
HN

O

O

O

NH

3 steps

Reaction 6
Under typical conditions the amine is generally
more kinetically favoured to react with the aryl
halide than the alcohol. Therefore, the major
product would be the N-arylated compound, not
the desired O-arylated ether.

Overall Assessment

This proposal ignores two very obvious and
detrimental side reactions that would prevent the
synthesis from succeeding. While some individual
transformations are sound, they are embedded
within a fundamentally flawed sequence.

Fig. 3 Selecting highly feasible routes. a Distribution of feasibility scores as determined by
Synthegy, for the four targets in SI-??. Results have been computed for solutions coming from 3
diﬀerent retrosynthesis engines and one experimentally validated route, for each target. b Example
analysis of a feasible synthetic route. The model determines that the two reactions are feasible and
the full plan is consistent. c Example of an unfeasible synthetic route. Synthegy correctly identiﬁes
2 key ﬂaws with the presented plan: namely an unfeasible last step, and an ineﬃcient and illogical
reaction sequence in preparation for a coupling reaction.

9

route for Target 2 may come from ineﬃciencies introduced as a result of batch syn-
thesis for screening purposes, where a single route is engineered to synthesize multiple
targets with a same scaﬀold, while varying R groups.

Further inspection of the most feasible solutions reveals that Synthegy enables
selection of highly elegant and feasible routes, avoiding protecting group cycles and
selecting robust reactions, as shown in Figure 3b. Poorly conceived routes are rapidly
discarded by Synthegy (see Figure 3c), citing redundant steps, high potential for
side-products and low yields in critical steps, poor regioselectivity, among others, see
SI-??.

This experiment demonstrates that, given a large and diverse enough space of ret-
rosynthetic solutions for a given target, Synthegy can identify and highlight those
that most align with a given query. Such queries can range from simple reaction spec-
iﬁcations or relative timing of scaﬀold formation, to complex feasibility assessments
otherwise unfeasible.

2.3 Mechanism Elucidation via LLM-Guided Search

A reaction mechanism is a speciﬁcation of why and how a given chemical transforma-
tion occurs, by means of a set of elementary steps [43]. The power of mechanisms in
chemistry lies not only in its explanatory power of a single reaction instance, but also
in that the reach of an explanation may extend further than only that reaction; poten-
tially explaining more observed reactions, and also even predicting potential unknown
transformations [42].

We deﬁne a set of elementary steps that can be applied to any given molecular
set (Methods 4.5 and Figure 4b); these elementary steps can generally be applied to
any bond/atom in any molecule, and thus serve as a fundamental basis for formu-
lating mechanisms. The task is then to, given a chemical reaction, ﬁnd a suitable
sequence of such elementary steps that connects the reactants with the products. The
search for the best path between reactants and products in chemistry has already
been tackled using diﬀerent ML paradigms, whether using generative models in rule-
based environments [8], contrastive learning [13], reinforcement learning in 3D space
[57] or ﬂow-matching [14]. Here, we show that LLMs reasoning can be useful for this,
even in complex cases. In our approach, an LLM analyzes a partially constructed
solution and rates a proposed mechanistic step that continues such solution. For evalu-
ation, we designed a benchmark comprising 12 diverse reactions (Figure 4f) along with
their mechanisms (SI-??). Performance is measured as the relative score gap between
ground truth and alternative moves, averaged over all the steps in the mechanism
(Methods 4.7). A perfect scoring model would highly rate correct over incorrect moves,
thus this metric correlates with performance in a real search setting by assessing the
selectivity of the model at each step.

As shown in Figure 4d, the best model evaluated achieves close to perfect perfor-
mance on simple reactions like nucleophilic attacks, and poorer performance on more
complex tasks like Michael additions on larger molecules and miscellaneous reactions
with more complex mechanisms. Despite this drop in performance, the best mod-
els can still distinguish good moves over alternative incorrect ones, indicating good

10

a Mechanistic elucidation

Input

Application

¥ Reaction (reactants
and products)
¥ Conditions (acid/
base, heat, catalyst(cid:201))
¥ Experimental  data

¥ Reaction discovery
¥ Condition
optimization
¥ Reaction
prediction

b Organic chemistry environment
Actions: elementary steps

¥ Ionization moves

¥ Attack moves

¥ Meaningful mechanism

c Result: Interpretable Mechanism of Transformations

Task #4: Hemiacetal formation between Formaldehyde and Methanol

H+

O

Me

OH

Me

(a, 2, 0)

+7.96
(4.52)

(i, 3, 2)

H

+0.88
(7.04)

O+

OH

Me

Me

H

C+

H

O

Me

OH

Me

(a, 0, 3)

HO

+7.76
(6.2)

Me

Me

H
O+

(i, 3, 2)

+8.64
(7.84)

HO

H+

O

Me

Me

d

Performance in mechanism elucidation

e

Effect of guidance prompt

a
t
l
e
d
e
r
o
c
s
d
a
b
-
d
o
o
G

8

6

4

2

0

No guidance
prompt

With guidance
prompt

10

8

6

4

2

0

#1

#2

#3

#4

#5

#6

#7

#8

#9

#10

#11

#12

Nu. attacks

Acetalizations

Task

Michael add.

Miscellaneous

4o-mini

4o

f

Mechanism (cid:222)nding tasks

Deepseek3

Claude-3.5

Claude-3.7

Gemini-2.5

Model

Task #1:
Nu attack of NH3 on cyclohexanone:

Task #2:
Selective Nu attack of NH3 on dione:

Task #3:
Selective Nu attack of NH3 on dione:

NH3

+

O

4 mov.

OH

NH2

NH3 +

Me

O

O

4 mov.

Me

H2N OH

O

Me

O

O

4 mov.

O

OH

Me

NH3 +

Me

Me

Me

NH2
Me

Task #4:
Hemiacetal formation:

Task #5:
Hemiacetal to Acetal:

Me

O

+

Me OH

+

H+

4 mov.

OH

Me

O

OH

+

Me

H+

Me

O

Me

+

H+

4 mov.

Me

Me OH

Me

O

O

H2O
+

H+

Me

Task #6:
Intramolecular acetal formation:

O

Me

HO

Me

+

H+

OH

8 mov.

O

O

Me

Me

+

H2O

H+

Task #7:
Enolate Formation + Michael Additon:

OH-

+

MeO2C

MeO2C

12 mov.

O

MeO2C

MeO2C

OH

+

OH-

Task #8:
Tautomerisation + Michael Addition:

N

Me

+

H+

8 mov.

NO2

+

H2O

Br

N

H2O

+

Br

Task #9:
Borohydride reduction of ketone:

Task #11:
Wittig Reaction:

4 mov.

O

+

NaBH4

+

Na+

-

BH3

O

O

+

PH3

8 mov.

+

H3P

O

Task #10:
Acyl chloride formation with SOCl2:

Task #12:
Transformation of molozonide to ozonide:

NO2

O

Ph

+

OH
SOCl2

14 mov.

Ph

O

Cl

+

HCl

SO2

O

O

O

8 mov.

O

O

O

Nucleophilic additions

Acetalizations

Michael additions

Miscellaneous reactions

Fig. 4 Mechanisms elucidation a) Requirements and impact of mechanistic elucidation. b) Exam-
ple of actions in our mechanism framework displayed on example structures, with a post-processing
interpretation. c) Example task broken down into moves compliant with our mechanism game frame-
work. d) Model separation performance, averaged across the full mechanism in each case, with n=5
repetitions. e) Comparison of global performance with and without guidance prompts. f) All starting
reactants and goal products of our 12 tasks, grouped by category.

adaptability of their chemical knowledge into new situations. Smaller models like gpt-
4o-mini generally perform badly, with poor performance even on the simplest of tasks,

11

(i, x, y)(i, x, y)1. (i, x, y)2. (a, z, x)(a, x, y)(a, x, y)

hinting at similar conclusions as in the previous sections: some complexity threshold
might exist after which LLMs become smart enough for being useful at these tasks
requiring strong chemical analysis.

Task (# steps)

1 (4)
2 (4)
3 (4)

4 (4)
5 (4)
6 (8)

7 (12)
8 (8)

9 (4)
10 (14)
11 (8)
12 (8)

4o Mini

4o

DS-3

Cd 3.5

Cd 3.7 Gm 2.5

50 ± 16
70 ± 10
55 ± 10

30 ± 10
35 ± 12
25 ± 8

20 ± 10
5 ± 4

30 ± 10
24 ± 10
32 ± 6
22 ± 9

Random baseline: 17%

55 ± 19
60 ± 12
70 ± 10

50 ± 16
50 ± 0
52 ± 5

48 ± 9
18 ± 10

30 ± 10
43 ± 6
28 ± 9
18 ± 6

75 ± 0
70 ± 10
80 ± 10

55 ± 10
50 ± 16
70 ± 13

20 ± 15
28 ± 7

60 ± 25
36 ± 12
35 ± 5
18 ± 6

90 ± 12
95 ± 10
75 ± 0

75 ± 0
80 ± 10
80 ± 6

75 ± 0
68 ± 3

30 ± 10
66 ± 3
50 ± 8
18 ± 6

100 ± 0
100 ± 0
100 ± 0

75 ± 0
80 ± 10
85 ± 5

80 ± 6
68 ± 10

80 ± 10
79 ± 5
62 ± 8
42 ± 6

100 ± 0
95 ± 10
100 ± 0

90 ± 12
70 ± 19
78 ± 39

72 ± 37
67 ± 34

40 ± 30
64 ± 23
57 ± 30
55 ± 19

Table 1 Top-1 accuracy on mechanisms elucidation tasks Percentage of
ground truth moves classiﬁed as strict top-1 when scored with 5 alternatives at
each step. Each row displays the results for each of the tasks on the left column.
The number of moves involved in each task are speciﬁed in parentheses. The
reported scores are percentage of correctly scored moves. Scores are reported for
LLMs alone, without the help of a guidance prompt deﬁning the mechanism. Each
column displays the results for each LLM. The column names used stand for:
4o-mini: GPT-4o-mini, 4o: GPT-4o, DS-3: DeepSeek-3, Cd 3.5: Claude-3.5-Sonnet,
Cd 3.7: Claude-3.7-Sonnet, Gm 2.5: Gemini-2.5-pro.

A key advantage of search guided by an LLM is that it allows the speciﬁcation
of any arbitrary amount of information, parameters and instructions, through the
LLM’s text interface. Particularly relevant for this task, the input consists of the reac-
tion (reactants and products), but could also contain the reaction conditions (solvent,
temperature, concentrations, etc), any available experimental data (such as kinetic
studies), among others. In this line of ideas, we experiment with text-guided search,
where search is guided by an external text describing the sequence of steps in a
hypothetical mechanism. The search here thus functions as a decoder from the input
text+reaction, into a proper sequence of elementary steps. The source of this external
text can be an expert human, or another LLM which, as is clear from the previous
sections, can accurately analyze reactions and describe their mechanisms. Figure 4e
shows that adding such information is generally beneﬁcial for performance, boost-
ing the performances of poorly performing LLMs, as is the case of gpt-4o-mini and
gpt-4o. Notably, even though Gemini-2.5-Pro’s base performance is already higher
than any other competitor, guidance prompts still provide additional and substan-
tial improvements. These results show the potential for including multiple sources
of information as input, hinting at the future possibility of automated mechanistic
(hypothesis) generation and closed-loop reﬁnement.

12

3 Discussion

In this work, we demonstrate that LLMs can serve as powerful tools enabling chem-
ical analysis at arbitrary levels of abstraction. We present Synthegy: a framework to
exploit these capabilities in scientiﬁcally relevant tasks in synthetic chemistry. Our
approach combines traditional search algorithms with LLMs’ sophisticated reason-
ing abilities, positioning the models as expert evaluators that can ﬁlter, rerank, or
guide search toward solutions that are aligned with chemical principles as well as
expert intent, across a wide rang of chemical scales. This integration helps overcome
fundamental limitations in existing tools while enabling more intuitive interfaces for
complex chemical tasks.

Our results ﬁrst establish that current LLMs possess remarkable capabilities for
detailed chemical reasoning, accurate analysis and evaluation of chemical objects at
multiple scales, from functional groups in molecules, to single reactions, to strategic
patterns in full synthetic routes. We leverage these capabilities through a framework
where candidate solutions are generated by traditionally used computational envi-
ronments, while LLMs analyze proposed solutions to assess their validity in relation
to the speciﬁed target solution. Furthermore, these capabilities can be leveraged to
directly guide search algorithms towards desirable and chemically-sensible solutions.
We showcase the practical utility of this approach through two challenging appli-
cations: strategy-aware synthesis planning and mechanism elucidation. In synthesis
planning, our system enables natural language speciﬁcation of strategic constraints,
allowing chemists to select solutions from computer assisted synthesis planning algo-
rithms, towards routes that are more aligned with their intent. Such intent can range
from speciﬁcations of the reaction sequences used or relative timings of scaﬀold for-
mation, to full assessments of general feasibility, enabling a novel way of selecting
promising and experimentally feasible synthetic routes. We demonstrate this through
an experimental study where Synthegy successfully selects the experimentally val-
idated route as highly-feasible, from a non-exhaustive pool of candidate solutions
proposed by several standard retrosynthesis tools.

We furthermore evaluate the system on experimentally validated routes for com-
plex targets like Strychnine, and show how the system correctly identiﬁes and
evaluates key strategic elements, not only providing key insights into the analyzed
solutions but also further validating the practical potential of Synthegy to select
solutions with speciﬁc properties, even for complex molecular scaﬀolds and strategic
requirements.

Similarly for mechanism elucidation, we show that a similar approach can success-
fully guide search towards chemically feasible mechanisms, starting only from a set of
simple and general elementary steps, making our approach generally applicable to a
large space of organic reactions. We note that any arbitrary speciﬁcation, guidance,
or initial condition can be encoded as input to the system, thanks to the ﬂexibility of
the LLMs’ text interface. We show the potential of this idea by experimenting with
”guidance prompts” in the input, which resemble intuitions of expert chemists about
how the mechanism of a given reaction should look like. These considerations can
be extended to include feedback from experiments, that iteratively reﬁne mechanistic
hypotheses.

13

However, some limitations remain. LLMs exhibited a number of failure modes,
more prominently eventual misunderstandings of the format of the input data, which
drives them to analyze reactions in an inverse sense and thus leading them to deem
routes unfeasible. Furthermore, some models display lazyness, which bias models’
responses towards shorter and overly simplistic and optimistic responses. Such behav-
ior can be traced back to pre- and post-training techniques used to train these models.
These limitations can be tackled by improved prompting techniques, task-speciﬁc ﬁne-
tuning, among others. Even with these limitations, we show that the current models
are very strong baselines, highlighting the potential for future improvements. More-
over, we show that success in the current implementation is very much dependent on
the quality and diversity of synthetic routes generated by the backend retrosynthesis
systems. Further research needs to go into the application of these strong capabilities
for directly guiding search methods towards solutions that align with prompts and
chemical principles, overcoming the inherent limitations of predeﬁned sets of solutions.
Looking forward, our framework opens new possibilities for computer-aided chem-
istry systems that better align with human chemical intuition while maintaining
computational precision. The ability to incorporate diverse forms of chemical knowl-
edge —from initial conditions, to practical constraints, experimental data, or even
expert intent— through natural language interfaces could make advanced compu-
tational tools more accessible to practicing chemists while enabling new forms of
human-AI collaboration in chemical research.

14

4 Methods

4.1 Large Language Models

Throughout this work we used several LLMs from diﬀerent providers, all through
litellm [58] as it provides a uniﬁed interface to multiple provider’s APIs. A tem-
perature of 0.1 has been used across all LLMs. The speciﬁc models used through-
out this work include: OpenAI models [49] (gpt-4o, gpt-4o-mini, gpt-4-turbo, o3,
o4-mini), Anthropic Claude models [59] (claude-3-sonnet-20240229, claude-3-opus-
20240229, claude-3-5-sonnet-20241022, claude-3-7-sonnet-20250219, claude-opus-4-
20250514, claude-4-sonnet-20250522, claude-2.1) , Meta LLaMA models [60] (llama-
3.3-70b-instruct,
llama-3.1-
405b-instruct), DeepSeek models [50] (deepseek-r1-0528, deepseek-chat-v3-0324,
deepseek-r1-distill variants), Google Gemini models [51] (gemini-2.5-pro-preview,
gemini-ﬂash-1.5, gemini-pro-1.5, gemini-2.0-ﬂash-001, gemini-2.5-ﬂash-preview), and
Qwen [61] (qwen3-32b).

llama-3.3-8b-instruct,

llama-4-maverick,

llama-4-scout,

4.2 Strategy-aware synthesis planning

In this work we present a framework for strategy-aware synthesis planning, which
integrates LLMs as evaluators within a traditional retrosynthetic search algorithm.
The process begins with a target molecule and a natural language query specifying
desired strategic features of the synthetic route. We employed the AiZynthﬁnder soft-
ware [16] as the underlying retrosynthesis engine to generate a diverse set of potential
synthetic routes for a given target molecule. For each candidate route generated by
the underlying retrosynthesis software, we constructed a detailed textual representa-
tion of the route, including SMILES strings of all intermediates and reactants, and the
sequence of transformations applied at each step. This textual representation, along
with the user-provided natural language query, is then passed to the LLM. The LLM
is prompted to analyze the synthetic route and evaluate its alignment with the strate-
gic requirements speciﬁed in the query. The LLM’s output is a score reﬂecting the
degree to which the route satisﬁes the user’s query, along with a textual rationale jus-
tifying its assessment. This score is then used to rank and ﬁlter the candidate routes
generated by AiZynthﬁnder, prioritizing routes that are deemed strategically relevant
by the LLM. This process allows us to leverage the systematic exploration capabili-
ties of AiZynth while incorporating the sophisticated chemical reasoning of LLMs to
guide the search towards strategically desirable synthetic pathways.

4.3 Feasibility assessment

To evaluate the capability of Synthegy to assess synthetic route feasibility, we collected
synthetic routes from multiple sources and compared their LLM-assigned feasibility
scores. Routes were obtained from three diﬀerent retrosynthesis engines alongside
experimentally validated routes from the literature.

We accessed synthetic routes through the following platforms:

15

AiZynth: Synthetic routes were obtained using the AiZynth retrosynthesis plan-
ning software [16] with default conﬁguration parameters. The software was run locally
using standard installation procedures and default model weights.

Reaxys: Synthetic routes were obtained through the Reaxys API using default
parameters as speciﬁed by the provider. Access was granted through institutional
licensing agreements. The API was queried using target molecule SMILES strings,
and the top-ranked routes (by Reaxys scoring) were collected for each target.

Synthia: Routes were generated using Synthia-Lite through their web interface
with default parameter settings. No speciﬁc parameter customization was performed,
utilizing the platform’s standard search algorithms and scoring functions. Routes were
collected in SMILES format for subsequent analysis.

Experimental Routes: Literature routes for targets T1-T4 were manually
extracted from their respective publications [54–56] and converted to SMILES for-
mat following the same reaction representation standards used for computationally
generated routes.

Feasibility Scoring:

All collected routes were evaluated using the Synthegy framework with gemini-2.5-pro
as the backend LLM, selected based on its superior performance in our benchmark
evaluation (Section 2.1). The feasibility assessment prompt (Section 2.2) was applied
consistently across all route sources. Each route was scored independently, with the
LLM providing both numerical scores (0-10 scale) and detailed rationales for feasibility
assessments.

4.4 Strategy-aware synthesis planning - Benchmark

To evaluate the performance of our strategy-aware synthesis planning framework,
we created a benchmark consisting of pairs of molecular targets and prompts. We
selected a diverse set of molecular targets that represent various levels of complex-
ity and synthetic challenges. These targets include both well-studied molecules and
novel compounds to ensure a comprehensive evaluation. For each molecular target, we
crafted prompts that speciﬁed desired strategic elements in the synthetic route. These
prompts ranged from simple reaction preferences to complex strategic requirements.
The speciﬁc prompts used are given in the SI ??.

As the system returns a set of routes, together with alignment scores, the primary
evaluation metric reported in this work is correlation with ground truth scores. The
scores are computed using scripts tailored for each target-prompt pair, and work by
ﬁnding a speciﬁcally deﬁned event in a synthetic route. For example, if the prompt
requires ”an early ring formation”, then this is translated into a script that ﬁnds ring-
forming reactions, together with the relative position of this reaction, if any, in the
route. A score is thus calculated to account for the happening of the reaction, and
it’s relative position, in this case giving a higher score to routes where a ring-forming
reaction occurs in the early stages (far from the ﬁnal product), and progressively lower
scores for routes when this happens in later stages. The minimum score is given to
routes where the ring-forming reaction doesn’t happen. The full scripts can be found
in the github repository.

16

4.5 Mechanism elementary steps

In order to create an exhaustive and computationally accessible state/action space,
mechanisms have been broken down into their most elementary components. Rooted
in the arrow-pushing formalism, the possible actions at each state (corresponding to
a set of molecules) consist of two fundamental types: ionisation and attack moves. An
ionisation move is deﬁned as any bond decreasing its bond order by one, ionising at the
same time on one of its terminal atoms. An attack move, on the other hand, is deﬁned
as any atom with a lone pair of electrons attacking any atom with an empty orbital,
increasing the bond order between them by one, and charging them correspondingly.
In both cases, a bond order of 0 corresponds to no bond existing between the two
atoms. As minimalistic as this set of moves might seem, it has proven to be quite
practical as a systematic way to enumerate and also to translate the majority of non-
radical chemistry. However, a limit has been found regarding concerted moves. Even
though such cases could often be detected and resolved via a post-processing process,
cases like SN1 vs. SN2 (which explicitly require one to know if the electron moves are
concerted or not) could not be resolved from the move sequence itself.

4.6 Mechanism elucidation - Benchmark

The mechanism elucidation benchmark was designed to include diverse cases of chem-
ical reactions. It includes several reaction types as well as diﬀerent scales of molecular
weight of the products, assessing diﬀerent levels of understanding of chemical prin-
ciples, molecular and reaction representations, and ability to understand the rules
proposed by the environment. In Figure 4c and SI-??, it is shown how a mechanism
is broken down into ionizations and attacks only.

4.7 Mechanism elucidation - Metrics

For each elementary step of the 12 reactions, we computed ﬁve alternatives to the
ground truth that are legal in our framework. At each step n of a certain mechanism
m, the LLM is prompted with the mechanistic rules deﬁned here, along with the
reactants and products of the reaction, as well as the history of ground-truth moves
up to step n − 1. The prompt also includes a possible next step — one of the 6 in
the benchmark — and instructs the LLM to score such move in a scale from 0 to
10 according to alignment with its knowledge of chemical principles and the given
reaction. The results presented here correspond to 5 independent runs on each step
for reproducibility. The main metric reported in Figure 4d, is the score delta between
the ground-truth option, and the mean score for the 5 alternative options, averaged
across all steps for a given task. Table 1 reports the percentage of moves for which
the ground truth option was given as a strict top-1 (score strictly higher than any of
the other possibilities).

Acknowledgments

A.M.B. and P.S. acknowledge support from the NCCR Catalysis (grant number
225147), a National Centre of Competence in Research funded by the Swiss National

17

Science Foundation. T.A.N. acknowleges support from Intel and Merck KGaA via
the AWASES programme. D.A. and Z.J. acknowledge support by the Swiss National
Science Foundation (SNSF) (grant number 214915). All the authors thank Merck
MPS/Synthia and Reaxys for access to their retrosynthetic software and outputs for
testing and evaluating the feasibility score.

Data and Code availability

All benchmarks and datasets used, along with the code have been released at https:
//github.com/schwallergroup/steer. Access to the proprietary LLMs GPT-4, Claude,
and DeepSeek can be obtained through each provider’s API. All data generated in
this work has been released at https://ﬁgshare.com/s/bcf0d2c747e50b7f48d7.

References

[1] Corey, E. J. & Wipke, W. T. Computer-assisted design of complex organic
syntheses: Pathways for molecular synthesis can be devised with a computer and
equipment for graphical communication. Science 166, 178–192 (1969).

[2] Schneider, G. Automating drug discovery. Nature Reviews Drug Discovery 17,

97–113 (2018).

[3] Guo, T. et al. What can large language models do in chemistry? a comprehensive
benchmark on eight tasks. Advances in Neural Information Processing Systems
36, 59662–59688 (2023).

[4] Cheng, G.-J., Zhang, X., Chung, L. W., Xu, L. & Wu, Y.-D. Computational
organic chemistry: bridging theory and experiment in establishing the mecha-
nisms of chemical reactions. Journal of the American Chemical Society 137,
1706–1725 (2015).

[5] Fortunato, M. E., Coley, C. W., Barnes, B. C. & Jensen, K. F. Data augmentation
and pretraining for template-based retrosynthetic prediction in computer-aided
synthesis planning. Journal of chemical information and modeling 60, 3398–3407
(2020).

[6] Mikulak-Klucznik, B. et al. Computational planning of the synthesis of complex

natural products. Nature 588, 83–88 (2020).

[7] Zimmerman, P. M. Automated discovery of chemically reasonable elementary

reaction steps. Journal of computational chemistry 34, 1385–1392 (2013).

[8] Bradshaw, J., Kusner, M. J., Paige, B., Segler, M. H. S. & Hern´andez-Lobato,
J. M. A generative model for electron paths (2019). URL https://arxiv.org/abs/
1805.10970. 1805.10970.

18

[9] Chen, J. H. & Baldi, P. No electron left behind: a rule-based expert system to
predict chemical reactions and reaction mechanisms. J. Chem. Inf. Model. 49,
2034–2043 (2009).

[10] Kayala, M. A. & Baldi, P. Reactionpredictor: prediction of complex chemical
reactions at the mechanistic level using machine learning. Journal of chemical
information and modeling 52, 2526–2540 (2012).

[11] Fooshee, D. et al. Deep learning for chemical reaction prediction. Molecular

Systems Design & Engineering 3, 442–452 (2018).

[12] Tavakoli, M., Mood, A., Van Vranken, D. & Baldi, P. Quantum mechanics and
machine learning synergies: Graph attention neural networks to predict chemical
reactivity. arXiv preprint arXiv:2103.14536 (2021).

[13] Tavakoli, M. et al. Ai for interpretable chemistry: Predicting radical mechanis-
tic pathways via contrastive learning (2023). URL https://arxiv.org/abs/2311.
01118. 2311.01118.

[14] Joung, J. F. et al. Electron ﬂow matching for generative reaction mechanism
prediction obeying conservation laws. arXiv preprint arXiv:2502.12979 (2025).

[15] Schwaller, P. et al. Molecular transformer: a model for uncertainty-calibrated

chemical reaction prediction. ACS Cent. Sci. 5, 1572–1583 (2019).

[16] Genheden, S. et al. AiZynthFinder: a fast, robust and ﬂexible open-source

software for retrosynthetic planning. J. Cheminf. 12, 1–9 (2020).

[17] Coley, C. W., Green, W. H. & Jensen, K. F. Machine learning in computer-aided
synthesis planning. Accounts of Chemical Research 51, 1281–1289 (2018).

[18] Corey, E. J. General methods for the construction of complex molecules. Pure

and Applied chemistry 14, 19–38 (1967).

[19] Fey, N. & Lynam, J. M. Computational mechanistic study in organometallic
catalysis: Why prediction is still a challenge. Wiley Interdisciplinary Reviews:
Computational Molecular Science 12, e1590 (2022).

[20] Phan, L. et al. Humanity’s last exam. arXiv preprint arXiv:2501.14249 (2025).

[21] Mirza, A. et al. Are large language models superhuman chemists? arXiv preprint

arXiv:2404.01475 (2024).

[22] Ruan, Y. et al. An automatic end-to-end chemical synthesis development plat-
form powered by large language models. Nature communications 15, 10160
(2024).

19

[23] Kumbhar, S. et al. Hypothesis generation for materials discovery and design using
goal-driven and constraint-guided llm agents. arXiv preprint arXiv:2501.13299
(2025).

[24] Cohrs, K.-H., D´ıaz, E., Sitokonstantinou, V., Varando, G. & Camps-Valls, G.
Large language models for causal hypothesis generation in science. Machine
Learning: Science and Technology (2024).

[25] Zimmermann, Y., Bazgir, A. & Blaiszik, B. Reﬂections from the 2024 large lan-
guage model (llm) hackathon for applications in materials science and chemistry.
ArXiv abs/2411.15221 (2024).

[26] Chen, K. et al. Chemist-x: Large language model-empowered agent for reaction
condition recommendation in chemical synthesis, arxiv, 2023. arXiv preprint
arXiv:2311.10776 (2023).

[27] Qian, C., Tang, H., Yang, Z., Liang, H. & Liu, Y. Can large language mod-
els empower molecular property prediction? arXiv preprint arXiv:2307.07443
(2023).

[28] Guo, D. et al. Deepseek-r1: Incentivizing reasoning capability in llms via

reinforcement learning. arXiv preprint arXiv:2501.12948 (2025).

[29] Jang, H., Jang, Y., Kim, J. & Ahn, S. Can llms generate diverse molecules?

towards alignment with structural diversity (2024). 2410.03138.

[30] Walters, P.
Molecules.
silly-things-large-language-models-do.html.

Language Models Do With
URL http://practicalcheminformatics.blogspot.com/2024/10/

Silly Things

Large

[31] Edwards, C. et al. Translation between molecules and natural language. Proc.

Conf. Empirical Methods Nat. Lang. Process. 375–413 (2022).

[32] Corey, E. J., Long, A. K. & Rubenstein, S. D. Computer-assisted analysis in

organic synthesis. Science 228, 408–418 (1985).

[33] Browne, C. B. et al. A survey of monte carlo tree search methods.

IEEE

Transactions on Computational Intelligence and AI in games 4, 1–43 (2012).

[34] Segler, M. H. & Waller, M. P. Neural-symbolic machine learning for retrosynthesis

and reaction prediction. Chem. Eur. J. 23, 5966–5971 (2017).

[35] Chen, B., Li, C., Dai, H. & Song, L. Retro*: Learning retrosynthetic planning
with neural guided a* search (2020). URL https://arxiv.org/abs/2006.15820.
2006.15820.

[36] Genheden, S. & Bjerrum, E. Paroutes: a framework for benchmarking retrosyn-

thesis route predictions. ChemRxiv (2022).

20

[37] Torren-Peraire, P. et al. Models matter: the impact of single-step retrosynthesis

on synthesis planning. Digital Discovery 3, 558–572 (2024).

[38] Armstrong, D., Joncev, Z., Guo, J. & Schwaller, P. Tango*: Constrained
synthesis planning using chemically informed value functions. arXiv preprint
arXiv:2412.03424 (2024).

[39] Yu, K. et al. Double-ended synthesis planning with goal-constrained bidirectional

search. arXiv preprint arXiv:2407.06334 (2024).

[40] Thakkar, A. et al. Unbiasing retrosynthesis language models with disconnection

prompts. ACS Central Science 9, 1488–1498 (2023).

[41] Westerlund, A. M., Saigiridharan, L. & Genheden, S.

Constrained syn-
thesis planning with disconnection-aware transformer and multi-objective
search (2024).
URL https://chemrxiv.org/engage/chemrxiv/article-details/
664ee4c291aefa6ce1c4fc8d.

[42] Murphy, M. A. Early industrial roots of green chemistry and the history of
the bhc ibuprofen process invention and its quality connection. Foundations of
Chemistry 20, 121–165 (2018).

[43] Clayden, J., Greeves, N. & Warren, S. Organic chemistry (Oxford University

Press, USA, 2012).

[44] Zhao, Q. & Savoie, B. M. Simultaneously improving reaction coverage and com-
putational cost in automated reaction prediction tasks. Nature Computational
Science 1, 479–490 (2021).

[45] Kaplan, J. et al. Scaling laws for neural language models.

arXiv preprint

arXiv:2001.08361 (2020).

[46] Dubey, A. et al. The llama 3 herd of models. arXiv preprint arXiv:2407.21783

(2024).

[47] Ouyang, L. et al. Training language models to follow instructions with human

feedback. Adv. Neural Inf. Process. Syst. 35, 27730–27744 (2022).

[48] Snell, C., Lee, J., Xu, K. & Kumar, A. Scaling llm test-time compute opti-
mally can be more eﬀective than scaling model parameters. arXiv preprint
arXiv:2408.03314 (2024).

[49] OpenAI. Gpt-4 technical report. arXiv preprint arXiv:2303.08774 (2023). URL

https://arxiv.org/abs/2303.08774.

[50] DeepSeek. From deepseek llm to deepseek r1. https://oilbeater.com/en/2025/

03/14/from-deepseek-llm-to-r1-1/ (2025). Accessed: 2025-06-26.

21

[51] DeepMind, G. Gemini (language model). https://en.wikipedia.org/wiki/Gemini

(language model) (2023). Accessed: 2025-06-26.

[52] Reaxys database (2024). URL https://www.reaxys.com. (Accessed Jul 29, 2021).

[53] Grzybowski, B. A., Badowski, T., Molga, K. & Szymku´c, S. Network search algo-
rithms and scoring functions for advanced-level computerized synthesis planning.
WIREs Comput. Mol. Sci. 13, e1630 (2023).

[54] Sabat, M. et al. Design and Discovery of a Potent and Selective Inhibitor of
Integrin α v β 1. Journal of Medicinal Chemistry 67, 10306–10320 (2024). URL
https://doi.org/10.1021/acs.jmedchem.4c00743. Publisher: American Chemical
Society.

of Potent Pyrazolopyrimidinone-Based WEE1

[55] Matheson, C. J., Casalvieri, K. A., Backos, D. S. & Reigan, P. Devel-
Inhibitors with
ChemMed-
https://onlinelibrary.wiley.
https://chemistry-

opment
Limited Single-Agent Cytotoxicity for Cancer Therapy.
Chem 13,
com/doi/abs/10.1002/cmdc.201800188.
europe.onlinelibrary.wiley.com/doi/pdf/10.1002/cmdc.201800188.

1681–1694

(2018).

eprint:

URL

[56] Zhu, X. et al. Activating p53Y220C with a Mutant-Speciﬁc Small Molecule
(2024). URL https://www.biorxiv.org/content/10.1101/2024.10.23.619961v1.
Pages: 2024.10.23.619961 Section: New Results.

[57] Barrett, R. & Westermayr, J. Reinforcement learning for traversing chemi-
cal structure space: Optimizing transition states and minimum energy paths of
molecules. The Journal of Physical Chemistry Letters 15, 349–356 (2024).

[58] Litellm. https://github.com/BerriAI/litellm. Accessed: 2025-06-26.

[59] Anthropic.

Model card and evaluations

for claude models.

https:

//www-cdn.anthropic.com/5c49cc247484cecf107c699baf29250302e5da70/
claude-2-model-card.pdf (2023). Accessed: 2025-06-26.

[60] Touvron, H., Martin, L., Stone, K. et al. Llama: Open and eﬃcient foundation
language models. arXiv preprint arXiv:2302.13971 (2023). URL https://arxiv.
org/abs/2302.13971.

[61] Team, Q. Qwen2.5 technical report. arXiv preprint arXiv:2412.15115 (2024).

URL https://arxiv.org/abs/2412.15115.

22

Supplementary Information: Chemical reasoning in
LLMs unlocks strategy-aware synthesis planning and
reaction mechanism elucidation

Andres M Bran1,2, Théo A. Neukomm1, Daniel Armstrong1,
Zlatko Jonˇcev1, Philippe Schwaller1,2
1École Polytechnique Fédérale de Lausanne (EPFL)
2National Centre of Competence in Research (NCCR) Catalysis
{andres.marulandabran,philippe.schwaller}@epfl.ch

1 Chemical reaction reasoning capabilities

Unless speciﬁed, all the experiments and results that follow were conducted with Claude-3.5-Sonnet
as the LLM.

1.1 LLM analytic capabilities on measurable tasks

We examine how LLMs comprehend synthetic strategy through their ability to describe the starting
materials used in a synthesis. Starting materials play a crucial role in determining synthetic strategy
through providing pre-constructed structural motifs, functional groups and stereocenters to the
synthesis pathway. An ability to parse, understand, and extract semantic value from starting materials
can be viewed as a necessary pre-condition for LLMs to understand entire synthetic routes. To
assess this, we ask an LLM to describe the synthetic route in relation to its starting materials. This
is then embedded using OpenAI’s embedding model "text-embedding-3-large", and a pairwise
similarity matrix is constructed using cosine similarity. In parallel we extract the starting material’s
SMILES from the relevant routes, and compute a similarly-constructed pairwise matrix using size of
intersection set as a similarity measure; this functions as the ground truth similarity matrix.

a | Correlation 0.506

b | Correlation 0.418

c | Correlation 0.467

d | Correlation 0.265

Embedding Cosine Similarity

e

f

Starting Material Set Overlap

g

h

1.0

0.8

0.6

0.4

0.2

0.0

1.0

0.8

0.6

0.4

0.2

0.0

y
t
i
r
a

l
i

m
i
s

e
n
i
s
o
C

p
a
l
r
e
v
o

l

a
n
o
i
t
c
a
r
F

Figure 1: Comparison between different comparison methods between synthetic routes in terms of
their starting materials. Top row shows the similarity computed as the cosine similarity between LLM
descriptions of the routes in terms of their starting materials. The bottom row is a fractional overlap
between the starting materials in each pair of routes. All plots are sorted according to clustering in
the plots of the top row.

Preprint. Under review.

The results in Figure 1 show a relatively high correlation between the two route comparison methods,
indicating that the LLMs can accurately describe synthetic routes, at least in terms of their starting
materials. In addition, the ﬁgures displayed show similar patterns between the ground truth (bottom
row) and the LLM-computed similarities (top row).

For a slightly more advanced task, we construct an experimental setting where an LLM is tasked
to extract all functional groups from the starting materials in a synthetic pathway. By doing so we
directly assess whether LLMs grasp the chemical constraints that dictate the available reaction space
and order of transformations. We use an in-house rule based system for functional group extraction
to determine the ground truth set and measure (treating a functional group as a token) the LLM’s
error using the Jaccard coefﬁcient (Figure 2).

Jaccard Co-efficient by model release date

Model Release Date
gpt-4 2023-03-14
gpt-4 2023-06-13
gpt-4 2023-11-06
gpt-4 2024-04-09
gpt-4o 2024-05-13
claude 2024-10-20
gpt-4o 2024-11-20
deepseek-v3 2024-12-27
claude 2025-02-24

t
n
e
i
c
i
f
f
e
-
o
C
d
r
a
c
c
a

J

1.0

0.8

0.6

0.4

0.2

0.0

A - 60 Routes

B - 58 Routes

C - 53 Routes

D - 39 Routes

Model Release Date grouped by Target Molecule

Figure 2: Jaccard similarity between ground truth functional groups in starting materials, and
functional groups extracted with an LLM. The boxplots represent a distribution across multiple routes
for a given target. The targets used are the same as shown in SI-2.

Claude-3.5-sonnet shows higher overall alignment with the rule-based ground truth, while GPT-4o-
mini generates more functional groups but suffers lower precision. Both LLMs show signiﬁcant
variance in their output. Minor formatting and naming differences between the rule-based and LLM
outputs obscure direct comparisons, likely understating the true accuracy of the LLMs. We leave an
anecdote that LLMs manage to correctly extract additional ring-system functional groups which are
not currently tagged by our rule-based approach.

1.1.1 Strategic elements in synthetic routes

Synthetic routes can be analyzed across multiple dimensions. Previous results show promise in
synthetic route analysis at the level of single molecules, however strategy in synthetic routes is
marked by a sequential, non-local analysis of the sequence of reactions 1, where some steps are
only performed in preparation for other steps down the line 2. An important pattern in synthesis is
the use of protecting groups, which temporarily mask reactive functional groups to allow selective
transformations 3. Correct understanding of protecting groups remains a major weakness of existing
synthesis tools. These tools often propose either non-selective reactions that require protection, or
conversely, include redundant protecting groups that add unnecessary steps 4,5.

In a ﬁrst experiment, we formulate the challenge as false positive detection, where LLMs identify
routes where protecting groups are proposed unnecessarily. We instructed the LLM to analyze each
synthetic route and tag them using a classiﬁcation scheme:

• No protecting group: Routes that correctly do not use protecting groups

• Protecting group needed not used: Routes requiring protection but lacking it

• Protecting group not needed but used: Routes with unnecessary protecting groups

2

• Protecting group needed and used: Routes that correctly use protecting groups

Routes tagged as either requiring but not containing , or containing unnecessary protecting groups
were subsequently subjected to in-depth analysis to evaluate the model’s reasoning capabilities.

In this experiment, we examined routes where retrosynthetic planning tools proposed unnecessary
protecting groups. The route is shown in 3. Claude-3.5-Sonnet successfully identiﬁed an unnecessarily
protected ethyl ester carboxylic acid that was carried through multiple steps and removed in the ﬁnal
step. The model’s analysis demonstrated sophisticated chemical reasoning, correctly determining
that:

• The initial amide bond formation could proceed selectively without protection due to the

substantially higher nucleophilicity of amines compared to carboxylic acids 6

• The penultimate phosgene-driven amide bond ring synthesis did not require carboxylic
acid protection due to kinetic and entropic advantages inherent in ﬁve-membered ring
formation 7,8

Me

F

N

H
N

N

HN

O

O

O

OH

O

F

N
H

Cl

Me

Me

F

N

O

H
N

N

HN

O

O

A Potent ³v´1 Integrin Antifibrotic
by Takeda

Me

O

F

Cl

O

N
H

Me

O

F

Cl

Cl

Me

+

O

O

H2N

NH2

F

Me

Me

N

N
H

NH2

O

Me

O

F

Me

O

H
N

O

N
H

Me

O

F

O

H2N

O

N
H

Me

Me

+

Cl

F

N

OH

NH

O

Cl

NH2

Figure 3: Case study on protecting groups 1.

In a second experiment, we investigate the inverse, that is ﬂagging routes which require protecting
groups at some stage, but don’t have them. The model correctly ﬂagged a reactive hydroxyl group that
could potentially undergo unwanted intramolecular polymerization with a bromide group elsewhere
in the molecule. Furthermore, the LLM proposed appropriate protection strategies, suggesting either
TBS (tert-butyldimethylsilyl) or MOM (methoxymethyl) protecting groups. This is demonstrated in 4

O

N

Et

O

N

O

NH

O

Molecular Glue Degrader
by Novartis

HO

O

N

O

+

I

N

Et

HO

O

NH

OEt

HO

O

Br

O

Me

OEt

H2N

+

O

O

NH

Figure 4: Case study on protecting groups 2.

3

2 Strategy-aware benchmark targets

The speciﬁc prompts and molecular targets used for the strategy-aware synthesis planning benchmark
are listed here:

O

N

Et

O

N

O

NH

O

Molecular Glue Degrader
by Novartis

A: Break piperidine and oxoisoindolinone rings in the synthesis. Get the piperidine-2,6-dione

from commercially available materials.

B: Break piperidine-2,6-dione and oxoisoindolinone rings in the retrosynthesis. Get the other

piperidine ring from commercially available materials.

C: Break only oxoisoindolinone ring in synthesis. Get piperidine-2,6-dione and piperidine

rings from commercially available materials.

Me

F

N

H
N

N

HN

O

O

O

OH

O

F

Me

N
H

Cl

A Potent ³v´1 Integrin Antifibrotic
by Takeda

D: No ring formation reaction.

E: Late imidazole ring formation.

F: Early imidazole ring formation.

Me

OH

Me

H

N

N

N

N

N

N

O

Wee1 kinase inhibitor
by Merck

N

N

Me

G: Don’t break any ring but get all rings from commercial materials.

H: Break pyrimidine in the early stage but get all other rings from commercially available

materials.

I: Identify the disconnection strategy that will cut the molecule in two similarly sized interme-

diates. The disconnection should be made between two piperidine rings.

4

N

O

N

N

Me

N

N

S

N

Me

Me

Cl

N

O

N

FF

F

N
H

N

Transcriptional Activator of p53
by Stanford and Uni Bonn

NH

Me

P

Me

O

J: Identify the disconnection strategy where the key disconnection will be made between indole

and amino-piperidine rings.

K: Identify the disconnection strategy that will cut the molecule in two similarly sized interme-

diates. The disconnection should be made between piperazine and piperidine rings.

L: Identify the disconnection strategy that will cut the molecule in two similarly sized in-
termediates. One intermediate will have piperidine, indole, and aniline rings. The other
intermediate will have thiophenol, chlorobenzene, diazepine, triazole, piperazine, and the
other piperidine rings.

M: Identify the disconnection strategy that will cut the molecule in two intermediates. The

disconnection should be made between diazepine and piperazine rings.

5

3 Analysis of alternatives for Strategy-aware Synthesis Planning

We compare our proposed LLM-guided strategy-aware retrosynthesis framework with potential
alternative approaches for tackling the ﬁltering or scoring synthetic routes according to user-speciﬁed
requirements. The approach we present in this work enables users to express arbitrary preferences
in natural language, with LLMs evaluating route alignment in an end-to-end, user-friendly manner.
Similar functionality can be achieved using traditional cheminformatics, custom code, and existing or
custom ML pipelines. Such alternatives however suffer from adaptability and ﬂexiblity constraints.
Here we analyze the practical requirements, applicability and limitations for several alternative
strategies in contrast to our method.

We structure this section as follows: We propose 4 case-studies, each represented by an input set
(molecular target, prompt). After this, an explanation follows on what it would take to reproduce a
similar behavior using other currently existing tools, and we ﬁnalize with a table that summarizes the
level of effort required in several areas.

6

3.1 Case study 1

Prompt: Late imidazole ring formation.

F

N

O

H
N

F

OH

O

N
H

Cl

N

HN

O

O

Tackling this prompt requires mainly 3 steps: (1) identifying the relevant structural motif (imidazole),
(2) identifying whether a reaction exists in the route, where that motif is formed, (3) judging if the
relative positioning of such reaction classiﬁes it as "late".

All these steps could be tackled with e.g. Python and RDKit, the full workﬂow is outlined below:

• Substructure SMARTS matching (e.g., [nH]1cncc1) to identify imidazole motifs in each

intermediate of each route

• For every reaction in the route, check for the appearance of the imidazole ring in the products,
not present in the reactants. If so, store the reaction ID and depth of the route where this
happens.

• Deﬁne "late" (e.g. as percentage of route progress)

Note that this workﬂow does not account for edge cases. For instance, if the imidazole ring comes
from a different ring (e.g. an imidazoline) through a functional group interconversion, this would
be classiﬁed as relevant by the alternative approach, which is technically correct but most likely not
what is meant by the user when and "imidazole ring formation" is requested.

Method

Rule-based
matics

cheminfor-

Not required

LLM-guided (ours)

Alternative workﬂow

Custom ML models

Not required

Commercial software

Not required

Custom SMARTS matching

Reaction parsing
Route traversal

Not required
Needs dataset of imidazole ring forma-
tions
Retrain/new classiﬁer per motif/query

No single tool to handle such ad hoc
query ﬂexibly

Robustness/Flexibility

Handles ambiguities in user
intent, ﬂexible

Brittle. Deﬁnition of "formation",
"late" must be hardcoded

Table 1: Comparison of route ﬁltering by expert-speciﬁed query for "Late imidazole ring formation"
using our LLM-based workﬂow versus standard cheminformatic approaches.

7

3.2 Case study 2.

Prompt: Break diazepine, thiophene, triazole, and piperazine rings. Get the other rings in the
synthesis from commercially available materials. After forming the piperazine ring don’t use
deprotections, but perform amide coupling with substructure that contains diazepine ring. Form the
connection between piperazine and diazepine moieties before proceeding to form fused triazole.

O
P

N
H

N

F

F

F

Cl

N

S

N

N N

O

N

H
N

O

N

N

N

Cheminformatics tools would be required to capture the presence and transformation of multiple
distinct ring systems (diazepine, thiophene, triazole, piperazine) at each step, requiring SMARTS
patterns for identiﬁcation and routines to detect bond breaking and formation events. The workﬂow
must track the provenance of all other ring systems throughout the route to verify that they are derived
from commercially available materials. Ensuring that deprotections are excluded after piperazine ring
formation, or that amide coupling with a diazepine precursor follows a given order, would require
custom logic for route traversal, dependency tracking, and event sequencing beyond standard toolkits.
Managing these requirements for even a single prompt would result in a brittle, highly customized
codebase, and each additional synthetic constraint (or change in the query) would necessitate new
rule-writing, testing, and validation. Neither existing ML pipelines nor available commercial CASP
tools support such high-level, context-dependent multi-objective logic without signiﬁcant manual
curation or scripting, sharply limiting their ability to generalize to new prompts of this complexity.

Method

Rule-based
matics

cheminfor-

LLM-guided (ours)

Alternative workﬂow

Not required

Write SMARTS patterns for diazepine,
thiophene,
triazole, and piperazine
rings
Detect formation/breaking of each ring
at stepwise level
Identify all other ring systems and
check their origin in the route
Implement logic for sequence/order of
speciﬁc transformations (after piper-
azine, before fused triazole, etc)

Custom ML models

Not required

Not required

Commercial software

Not required

No single tool to handle such ad hoc
query ﬂexibly

Robustness/Flexibility

Captures sequence and com-
positional logic in natural
adapts to sub-
language;
tle/overlapping criteria

Each logic constraint must be for-
mally coded, sensitive to deﬁnition er-
rors and combinatorial explosion with
query complexity

Table 2: Comparison of workﬂow required to ﬁlter for the complex prompt: "Break diazepine,
thiophene, triazole, and piperazine rings. Get the other rings in the synthesis from commercially
available materials. After forming the piperazine ring don’t use deprotections, but perform amide
coupling with substructure that contains diazepine ring. Form the connection between piperazine and
diazepine moieties before proceeding to form fused triazole."

8

4 Extended benchmarking results

We experimented with a wide variety of LLMs to assess the capabilities of different categories of
LLMs, including open and closed, as well as small and large models. Additionally, we also tested
different models trained speciﬁcally for reasoning, such as DeepSeek-r1 models and OpenAI’s o3
and o4-mini, with the goal of obtaining a thorough understanding of the achievable capabilities with
the current state-of-the-art models. The results are shown in Figure 4.

a  Performance analysis of Reasoning Models

Target 1

Target 2

Target 3

Target 4

b  Performance analysis of Flagship Open Models

Target 1

Target 2

Target 3

Target 4

c  Performance analysis of Llama Models

Target 1

Target 2

Target 3

Target 4

Figure 4a shows the detailed performances for several reasoning models. As can be seen, gemini-
2.5-pro is the leading model, followed by o3 and the open-weights DeepSeek-r1. Smaller versions
of the latter do not perform nearly as good, and this might be due to the fact that they are distilled
versions of the larger model and have more speciﬁc strong capabilities in other areas. The same
observation applies to o4-mini, a smaller version of a stronger (to this date unreleased) model, o4.

9

These observations about smaller models further conﬁrm the hypothesis that the chemical analysis
capabilities needed for tackling the tasks proposed in this paper are available only beyond a certain
threshold in model size. This question remains still open however, and it is left for future work to see
if ﬁne-tuned LLMs tailored for this speciﬁc task perform as good, or even better than commercial,
general LLMs.

The picture for open models, in Figure 4b, looks promising thanks to DeepSeek-r1, however the rest
of open models evaluated here did not display strong enough performance to be considered useful for
the purposes of our framework. It is still an open question if ﬁne tuning of these open models can
unlock new capabilities in open models, that can get close or even surpass the leading LLMs, on the
speciﬁc tasks relevant to this work.

10

5 Evolution of LLM capability over the years

Reasoning and problem-solving capabilities have been assessed in LLMs since early years of de-
velopment. Previous research has consistently demonstrated that these capabilities exhibit two key
characteristics: ﬁrst, they tend to emerge at certain model size thresholds rather than appearing
gradually 9, and second, they scale predictably with model size and training compute 10,11. Studies
on mathematical reasoning 12, code generation 13, and multi-step problem solving 14 have all shown
similar patterns where performance remains relatively ﬂat until a critical model size is reached, after
which capabilities improve dramatically.

Our results on chemical analysis tasks follow these established trends, as illustrated in Figure 5.
The temporal progression of model performance shows a clear upward trajectory, with more recent
models consistently outperforming their predecessors. Notably, even the weakest models released in
2025 achieve performance levels that surpass the state-of-the-art models from 2023, demonstrating
the rapid pace of improvement in this ﬁeld. This improvement is particularly pronounced for models
released after 2024, coinciding with the introduction of more reasoning-focused training techniques.

The ﬁgure also reveals that the performance gains are not merely incremental but often substantial,
with new model families showing signiﬁcant jumps in capability. This pattern suggests that the
underlying improvements in model architecture, training methodologies, and scale continue to unlock
new levels of reasoning ability, even for specialized tasks like chemical analysis that were not
explicitly targeted during training. The consistent improvement across different model families and
organizations indicates that these advances represent genuine progress in fundamental reasoning
capabilities rather than task-speciﬁc optimizations.

Major
performance
jump

First good
performing
model

First
competitive
open model

11

6 Sample model responses

Synthegy Score:
10/10

Me

N

N

O

N

N

N

N
H

N

Me
HO

N

Me

Me

N

#1

N

N

+

S

N

O

N

N

NH2

Me
HO

N

Me

Reaction 1
The primary aromatic amine of 4-(4-methylpiperazin-1-yl)aniline acts as a nucleophile, attacking the
electron-de(cid:222)cient heteroaromatic ring. It displaces the methylthio (-SME) group, which serves as an effective
leaving group. This reaction forms a diarylamine, creating a crucial N-aryl bond between the aniline nitrogen
and the purine-like core [(cid:201)] After the (cid:222)rst arylation, the resulting secondary amine (N-H) is signi(cid:222)cantly less
nucleophilic due to the electron-withdrawing effects of the two attached aromatic systems. This inherent
deactivation effectively prevents a second arylation event, ensuring selective mono-N-arylation. This
directly addresses the query(cid:213)s desire to (cid:210)avoid common issues [(cid:201)] such as polyarylation.(cid:211)

Overall Assessment
The proposed synthetic route, consisting of a single late-stage SNAr reaction, is a perfect illustration of a
strategy that ful(cid:222)lls all the requirements of the query. The query asks for a method to form an N-aryl bond
that is selective and avoids common problems like polyarylation and side reactions, particularly in complex
molecules.

Synthegy Score:
10/10
Me

N

N

O

N

N

N

N
H

N

Me
HO

N

Me

Me

N

N

O

N

N

N

O

S

N

O

N

Me

Me

HO

+

NH2

#3

O

N

N

N

S

N

N

Me

Me

HO

Reaction 3

This  reaction  describes  the  oxidation  of  the  methyl  sulﬁde  group  (-SMe)  on  the  heterocycle  to  a  methyl
sulfone group (-SO2Me). This is a functional group interconversion.
Relevance to Query: This step does not form an N-aryl bond itself, so its direct relevance is low. However, its
strategic relevance is very high. The oxidation is a crucial enabling step for the subsequent reaction. A
methyl  sulfone  is  a  potent  electron-withdrawing  group  and  an  excellent  leaving  group  in  nucleophilic
aromatic  substitution  (SNAr).  This  transformation  activates  the  heterocyclic  ring  for  a  highly  selective  N-
arylation in the next step. Therefore, this reaction is a key part of an overall strategy that directly addresses
the query’s goals.

The proposed synthetic route, focusing on the coherent sequence of Reactions #4, #3, and #2, is
outstandingly relevant to the query. It presents a sophisticated, multi-step strategy that employs two
different, modern, and highly selective methods to form two distinct N-aryl bonds in the target molecule. [(cid:201)]

Overall Assessment

Second, and most importantly, the plan culminates in a late-stage Nucleophilic Aromatic Substitution (SNAr)
reaction (Reaction #2). This key step is masterfully set up by the preceding oxidation (Reaction #3). [(cid:201)]
This approach directly addresses the call for a method that "achieve selective mono-N-arylation, even in the
presence of multiple reactive sites" while avoiding issues common to other coupling methods.
The overall plan is not just a single reaction but a well-thought-out sequence that showcases strategic
thinking in modern organic synthesis to solve the precise problem of selective N-arylation.

12

Synthegy Score:
8/10

Me

N

N

O

N

N

N

N
H

N

Me
HO

N

Me

#1

Me

N

Br

+

NH

O

N

N

N

N
H

N

Me
HO

N

Me

Reaction 1

This step also forms an N-aryl bond, but its alignment with the query's goals is more questionable than
the  previous  step.  While  modern  catalytic  methods  can  be  highly  selective,  applying  them  to  such  a
complex  substrate  raises  concerns.  The  molecule  already  contains  a  secondary  amine  (-NH-aryl)  from
Reaction  #2.  This  amine  is  also  nucleophilic  and  could  potentially  compete  in  the  coupling  reaction,
leading  to  undesired  dimerization  (coupling  with  another  molecule  of  the  aryl  bromide  starting
material).  The  query  speci(cid:222)cally  requests  strategies  that  avoid  "regioselectivity  problems"  and  "side
reactions  with  other  nucleophiles,"  especially  in  the  presence  of  "multiple  reactive  sites."  Performing  a
Buchwald-Hartwig reaction on a substrate that contains an unprotected secondary amine is a potential
violation  of  this  principle,  as  it  introduces  a  signi(cid:222)cant  risk  of  side  reactions.  A  more  robust  plan  would
likely  involve  a  protecting  group  strategy  to  prevent  such  an  issue.  Therefore,  this  speci(cid:222)c  step  is  less
representative of the ideal, problem-free strategy described in the query.

The proposed synthetic route, focusing on the coherent sequence of Reactions #4, #3, and #2, is
outstandingly relevant to the query. It presents a sophisticated, multi-step strategy that employs two
different, modern, and highly selective methods to form two distinct N-aryl bonds in the target molecule. [(cid:201)]

Overall Assessment

Second, and most importantly, the plan culminates in a late-stage Nucleophilic Aromatic Substitution (SNAr)
reaction (Reaction #2). This key step is masterfully set up by the preceding oxidation (Reaction #3). [(cid:201)]
This approach directly addresses the call for a method that "achieve selective mono-N-arylation, even in the
presence of multiple reactive sites" while avoiding issues common to other coupling methods.
The overall plan is not just a single reaction but a well-thought-out sequence that showcases strategic
thinking in modern organic synthesis to solve the precise problem of selective N-arylation.

13

7 Case Studies - Selection of feasible synthesis routes

In this section we show some examples of Synthegy’s capabilities at detecting errors and potential
problems in synthetic routes, highlighting single-reaction failures as well as overall inefﬁciencies
among others, leading it to give low scores for those routes.

Synthegy Score:
2/10

Me

N

N

O

N

N

N

N
H

N

Me
HO

N

Me

H2N

#1

+

Cl

Me

N

Cl

O

N

N

N

N
H

N

Me
HO

N

Me

#2

H2N

O

N

N

N

Cl

N

Me
HO

N

Me

+

NH2

Reaction 2

Reaction #2. Depth: 1 Transformation: In the forward direction, this is a nucleophilic aromatic substitution
(SNAr)  reaction.  A  purine,  activated  by  a  chloro-substituent  at  the  C6  position,  reacts  with  p-
phenylenediamine.  An  amino  group  from  the  diamine  displaces  the  chloride  to  form  an  N-C(aryl)  bond.
Relevance  to  query:  This  reaction  is  a  key  N-aryl  bond-forming  step  and  is  therefore  central  to  the  query.
However,  the  strategy  employed  directly  contradicts  the  query’s  requirements.  Using  a  symmetrical
difunctional  nucleophile  like  p-phenylenediamine  is  a  classic  scenario  that  leads  to  polyarylation,
where  the  product  can  react  again  with  another  molecule  of  the  chloro-purine.  The  proposed  reaction
does not specify any a method (e.g., large excess of diamine, use of a monoprotected amine) to achieve the
desired  selective  mono-N-arylation.  It  exempliﬁes  a  strategy  that  suffers  from  the  exact  problems  the
query seeks to avoid.

Overall Assessment

The proposed synthetic route is topically relevant as it contains two distinct N-aryl (or heteroaryl) bond-
forming steps. However, it fails to meet the speci(cid:222)c requirements outlined in the query. The query explicitly
asks for strategies that avoid common problems like polyarylation and regioselectivity, favoring selective
mono-N-arylation.
The proposed route does the opposite:
Late-Stage N-arylation (Reaction #2): The key step to install the aniline moiety uses p-phenylenediamine
in an SNAr reaction. This is a textbook example of a reaction that is highly prone to polyarylation, the
primary issue the query seeks to avoid. A superior strategy, in line with the query, would involve using a
mono-protected diamine (e.g., 4-nitroaniline followed by reduction, or 4-aminoacetanilide followed by
deprotection) to guarantee mono-arylation.

14

Synthegy Score:
1/10

Me

N

N

O

N

N

N

N
H

N

Me
HO

N

Me

#1

OH

+

N

HN

Me

O-

N+

O

OH

#5

H

H

+

N

Me

N

HO

O-

N+

O

Reaction 5

Relevance to Query: This proposed transformation is chemically unsound and thus not feasible. A simple
reaction between a diol and an amine will not result in this selective C-N bond formation and C-O bond
cleavage. To achieve this, one would need to (cid:222)rst selectively mono-activate one of the hydroxyl groups (e.g.,
convert it to a tosylate or mesylate leaving group), a step that is notoriously dif(cid:222)cult to control and often gives
mixtures  of  unreacted,  mono-activated,  and  di-activated  products.  The  subsequent  reaction  with
methylamine  would  then  proceed  via  an  SN2  reaction.  The  proposed  single-step  reaction  completely
ignores this necessary and challenging chemistry. Therefore, it fails the query’s requirement for a "highly
feasible  synthesis".  The  potential  for  side  reactions  (e.g.,  formation  of  a  morpholine  ring  via  intramolecular
cyclization,  bis-amination)  is  extremely  high,  contradicting  the  need  to  consider  and  minimize  byproducts.
This is a critical flaw early in the synthesis.

Overall Assessment
The proposed synthetic route is deeply flawed and does not align well with the query for a "highly feasible
synthesis with high overall yields". The plan appears to be a disjointed combination of two different synthetic
pathways. Main Pathway (Reactions #5, #4, #3, #2): The core strategy of this pathway is sound(cid:209)a
convergent approach involving the synthesis of a heterocyclic core and an aniline side-chain, followed by
their coupling via a robust SNAr reaction (Reaction #2). The SNAr coupling and the nitro reduction (Reaction
#4) are excellent, standard steps. The N-arylation (Reaction #3) is also plausible, though with potential
regioselectivity issues. However, this entire pathway is invalidated by Reaction #5, which describes a
chemically impossible transformation for the synthesis of the key aniline building block. A synthesis plan is
only as strong as its weakest link, and this plan fails at a very early and critical stage.

15

8 Case studies in complex synthetic routes

To study with more detail the analytical patterns of LLMs when considering synthetic routes, we
setup a case study using two molecules for which several routes have been published throughout
the years: atorvastatin 15,16 and strychnine 17. We select Claude-3.7-Sonnet for this analysis. We
design a set of expert prompts that aim to describe speciﬁc strategic details of selected routes 18, see
SI-8.1. Our framework is then used to score each of the routes based on their alignment to each of
the prompts, and we evaluate whether LLMs can effectively separate the described route from the
rest, given a suitable prompt.

The results for Atorvastatin in Figure 5a show that the LLM is indeed capable of detecting the
exact transformation, within the complete retrosynthetic tree, that satisﬁes the expert query, and
consequently scoring this route highly (9/10). As anticipated in the previous section, the LLM follows
a strategy of analyzing each reaction individually and in relation with the query, then revising the
produced analyses to synthesize a ﬁnal summary that evaluates the alignment with the query, along
with the ﬁnal score, which we use for evaluation. Among the key features of correct analyses, we ﬁnd
typically correct description of reactions in terms of the names, reaction mechanisms, and overall
features of the transformations at hand. When analyzing the key transformation (step 5 in this case),
the LLM correctly characterizes the ring formation reaction — correct mechanistic considerations,
emerging functional groups — and correctly highlights its alignment with the query’s requirement
(Figure 5b). In this example, it’s worth noting that the LLM is successful at navigating a chemical
space of more than 30 ring systems across over 10 complex reactions.

a Atorvastatin: Key Disconnections that lead to high score based on expert prompt.

c Strychnine: Key Disconnections that lead to high score based on expert prompt.

F

N

Me

HN

Me

O

OH

OH

O

 4 steps

OH

F

N

HN

Me

O

Me

F

O

O

step 5

O

O

HO2C

N

O

O

HN

Me

Me

Other 4 steps

N

C

H

D

H

E

G

H

H
F

O

H

A

B
N

O

 23 steps

NC

A

B
N
H

OMe

step 24

OMe

Me

Me

N

A

B
N
H

OMe

step 25

OMe

A

B
N
H

Fischer indole
synthesis

H
N

H2N

OMe

OMe

step 26

A

OMe

OMe

Expert query: Perform the disconnection of the side chain in racemic manner.
Break pyrrole ring using [3+2] decarboxylative cyclization.

Expert query: Break indole ring (ring B) using Fischer indole synthesis early in the route.

b LLM output for steps speci(cid:222)ed in a) and overall conclusion.

d LLM output for steps speci(cid:222)ed in c) and overall conclusion.

These steps involve protecting group manipulations and reveal a key disconnection of
the pyrrole core structure. Reaction #5 particularly shows the breaking of the pyrrole
ring into an alkyne and an amide component, which aligns with the query’s requirement
for "[3+2] decarboxylative cyclization."

These steps involve the formation of an indole ring from a phenylhydrazine and a
ketone, which is the key Fischer indole synthesis. This appears at depth 24-26, which is
very early in the synthetic sequence (far from the target), aligning well with the query’s
requirement for "early" Fischer indole synthesis.

LLM analysis (step 4 & 5)

LLM analysis (step 24, 25 & 26)

LLM analysis (overall)

LLM analysis (overall)

The proposed synthetic route shows strong alignment with the query requirements for
several reasons: [(cid:201)]
2. Pyrrole Ring Formation:
- The sequence includes the [3+2] decarboxylative cyclization strategy for pyrrole
formation
- The disconnection reveals appropriate precursors (alkyne and amide components)
[(cid:201)]
<score>9</score>

The proposed synthetic route shows excellent alignment with the query requirements
for several reasons:
1. The Fischer indole synthesis is indeed used early in the sequence (at depth 24-26)
2. The indole ring (ring B) is constructed using classical Fischer conditions
3. The timing is appropriate - the indole formation occurs far from the target molecule,
allowing for subsequent elaboration of the scaffold [(cid:201)]

<score>9</score>

Figure 5: High-ranked route examples for complex syntheses. a) Key Disconnections of atorvas-
tatin that leads to high score based on expert prompt as detected by LLM. b) LLM’s reasoning about
these transformations, and ﬁnal analysis to check alignment with expert query and score the route.
c) Key Disconnections of strychnine that leads to high score based on expert prompt as detected by
LLM. d) Corresponding LLM reasoning.

We conduct a ﬁnal stress-test on a molecule whose synthesis has been regarded as one of the key
achievements in early organic synthesis, and for which novel synthetic methods are still being
developed due to its complexity and academic interest — strychnine. A higher number, and more
complex routes have been published for this archetypal natural product, making it ideal for a
comparison of this kind. Our results show that the best LLMs are indeed able to correctly detect
different synthetic strategies for several lengthy routes, of over 20 reaction steps. In particular, the
example in Figure 5c demonstrates how the system is able to detect and highly score Woodward’s
strychnine synthesis, from a descriptive strategy-oriented query. The high score in detecting Fischer
indole synthesis (Figure 5d) demonstrates that LLMs can effectively analyze SMILES strings of
extended synthetic trees of complex natural products, such as those with 26 reaction steps, while
remaining attentive to the original prompt.

These results represent strong evidence that current LLMs are capable of analyzing and interpreting
molecules, reactions, and synthetic routes across multiple dimensions, from structural analysis to
synthetic strategy. Furthermore, our results show that these capabilities can directly be exploited

16

in combination with traditional search algorithms, further expanding the possibilities of these high-
performing systems and, as shown, enabling strategy-aware synthesis planning.

17

8.1 Strategic queries used in the case studies

The objective with this case-study is to determine whether, given some speciﬁcation of a route in
terms of desired strategic elements, our framework can selectively yield the correct route, from a set
of real routes with historical relevance. Here we present the

OH

OH

O

N

OH

O

NH

F

Atorvastatin

Prompts for Atorvastatin: We use the dataset of historical routes from 19, contains 3 routes, which
can be roughly categorized in terms of the strategic disconnection of the central polysubstituted
pyrrole ring: decarboxylative, formal [3+2] cyclization, or through a Paal-Knorr pyrrole synthesis
reaction. Prompts were designed to represent these categories as follows.

1. Break pyrrole ring relatively early in the retrosynthesis through Paal-Knorr condensation to

provide convergent synthesis.

2. Perform the disconnection of the side chain in racemic manner. Break pyrrole ring using

[3+2] decarboxylative cyclization.

3. Break pyrrole ring using [3+2] decarboxylative cyclization.

N

H

N

H

O

H
Strychnine

O

Prompts for Strychnine: We obtain 10 routes from 19 which are adapted from works in the
literature. The research articles where these routes are presented tend to describe the strategy in better
detail, hence our prompts are derived from such publications:

1. Break indole ring (ring B) using Fischer indole synthesis early in the route.
2. Strategically use veratryl group as a source of muconic ester via oxidative cleavage, prior to

synthesizing pyridone ring.

18

9 Cost and Latency analysis

A key concern for the deployment of Synthegy in practical synthetic planning workﬂows is the
potential costs and latency associated with LLM usage. To better understand this, we analyze
the costs and latency associated with 3 LLMs used in this work: Gemini-2.5-pro, DeepSeek-R1,
and Claude-3.5-Sonnet. Results are displayed in Table 3. Our analysis demonstrates that the
computational requirements for reranking synthetic routes are modest, with individual evaluations
completing in seconds to minutes at costs not exceeding 15 USD for the best-performing models. For
a typical synthesis requiring the evaluation of 60 candidate routes, the entire reranking process can be
completed within 12 minutes at a cost of approximately $2-3, making it highly accessible for routine
use in both academic and industrial settings. Furthermore, costs are dropping rapidly while model
performance continues to improve dramatically 20. This trajectory suggests that future applications
could be both exceptionally cheap and highly performant, positioning our current work as a very
early demonstration of capabilities that will become increasingly powerful and accessible over time.

Table 3: LLM Cost Analysis for strategy-aware synthesis planning. The analysis demonstrates the
feasibility of deploying LLM-based reranking for synthetic route optimization. For a single synthesis
requiring reranking of 60 candidate routes, the process can be completed in under 12 minutes using
Claude-3.5-Sonnet with excellent results at a cost of only $2.19 per batch. Even the most accurate
approach using Gemini-2.5-Pro would cost under $3.24 per molecular target while maintaining
high-quality chemical reasoning, making this technology highly accessible for routine synthetic
planning workﬂows.

Model

Gemini-2.5-Pro DeepSeek-R1 Claude-3.5-Sonnet

Avg Tokens
Cost per Call ($)
Latency per Call (s)
Cost per Batch ($)
Benchmark Time
Benchmark Cost ($)
Performance (corr)

2,533 / 5,067
0.0540
74
3.24
22m
12.96
0.56

4,697 / 9,393
0.0225
198
1.35
1h30
5.40
0.36

917 / 1,833
0.0365
12
2.19
5m
8.75
0.38

19

10 Mechanistic benchmark design

Here we illustrate the process of predicting elementary moves in a chemical transformation using the
LLM as described in the main article. For each reaction, we formulated the associated mechanism
using the elementary moves described in the manuscript, this is the ground truth pathway. At each
step, we add 5 additional options that represent alternative moves that possibly not lead to the correct
product and would typically count as incorrect moves.

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

NH3

+

O

1. (i, 1, 2)
2. (a, 7, 1)

O-

H
N+
H

H

3. (i, 6, 5)
4. (a, 3, 0)

OH

NH2

Figure 6: Description of Task 1 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves that
are part of the ground truth sequence but have already been traversed, serving as a check against loops
in the prediction model. b Isolates the ground truth and c provides an interpretation of the reaction
mechanism derived from the ground truth sequence using the electron movement representation.

20

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

NH3

+

Me

O

O

1. (i, 4, 5)
2. (a, 8, 4)

Me

H

H

N+

H

O

O

Me

Me

3. (i, 9, 8)
4. (a, 3, 0)

HO NH2

O

Me

Me

Figure 7: Description of Task 2 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves that
are part of the ground truth sequence but have already been traversed, serving as a check against loops
in the prediction model. b Isolates the ground truth and c provides an interpretation of the reaction
mechanism derived from the ground truth sequence using the electron movement representation.

21

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

O

O

1. (i, 1, 2)
2. (a, 8, 1)

NH3

+

Me

Me

O

O-

Me

H

N+

Me

H

H

3. (i, 9, 8)
4. (a, 3, 0)

Me

O

OH

NH2
Me

Figure 8: Description of Task 3 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves that
are part of the ground truth sequence but have already been traversed, serving as a check against loops
in the prediction model. b Isolates the ground truth and c provides an interpretation of the reaction
mechanism derived from the ground truth sequence using the electron movement representation.

22

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

Me

O

Me OH

+

H+

1. (a, 2, 0)

Me OH

Me

H

O+

2. (i, 3, 2)
3. (a, 0, 3)

Me

Me

O+

H

O

H

4. (i, 3, 2)

OH

Me

O

+

Me

H+

Figure 9: Description of Task 4 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

23

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

OH

H+

1. (a, 1, 0)

Me

O

Me

+

Me OH

Me OH

H

O+

Me

H

O

Me

2. (i, 3, 2)
3. (a, 0, 3)

Me

Me

O+

H

O

4. (i, 1, 2)

Me

+

H2O

Me

H2O

Me

O

O

Me

H+

Figure 10: Description of Task 5 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

24

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

O

Me

HO

Me

+

H+

OH

1. (a, 3, 0)

H

O+

Me

HO

Me

OH

2. (i, 5, 4)
3. (a, 0, 5)

H

O

Me

O+

H

Me

HO

4. (i, 4, 3)
5. (a, 6, 0)

Me

H

O

H

H

O+

Me

O

6. (i, 4, 5)
7. (a, 0, 4)
8. (i, 1, 2)

O

O

Me

Me

+

H2O

H+

Figure 11: Description of Task 6 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

25

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

OH-

H

H

CO2Me

CO2Me

+

1. (i, 5, 14)
2. (a, 16, 0)

H

O

CO2Me

CO2Me

+

O

3. (i, 1, 0)
4. (a, 7, 1)
5. (i, 2, 3)
6. (a, 1, 2)

O-

+

H

O

H

MeO2C

CO2Me

7. (i, 15, 16)
8. (a, 3, 0)

MeO2C

MeO2C

OH

+

OH-

Figure 12: Description of Task 7 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

26

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

H+

N

H2O

H

H

H

1. (a, 21, 0)
2. (i, 20, 22)
3. (i, 22, 21)
4. (a, 22, 21)
5. (a, 24, 0)

NO2

Br

H

N

Br

6. (i, 1, 0)
7. (a, 22, 20)
8. (i, 3, 4)
9. (a, 21, 3)
10. (i, 23, 24)
11. (a, 19, 0)

NO2

H

H

O+

H

H

N+

NO2

H2O

+

Br

12. (i, 23, 22)

N

NO2

H2O

+

H+

+

Br

Figure 13: Description of Task 8 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

27

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

1. (i, 1, 2)
2. (i, 8, 7)
3. (a, 0, 3)

O

+

H

H

B-

H

H

Na+

O-

H

H

4. (a, 5, 0)

+

Na+

B

H

+

Na+

-

BH3

O

Figure 14: Description of Task 9 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

28

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

O

S

Cl

Cl

O

1. (i, 1, 0)
2. (i, 1, 2)
3. (a, 2, 12)
4. (a, 5, 4)

Ph

OH

Cl

S

O

O

Cl

Ph

H

O+

5. (i, 3, 5)
6. (a, 5, 4)

Cl-

O

S

O

Cl

Ph

H

O+

7. (i, 2, 1)
8. (a, 0, 2)

9. (i, 4, 6)
10. (i, 2, 4)
11. (a, 2, 1)
12. (a, 4, 5)

Ph

Cl

Cl-

H

O+

O

S

O

13. (i, 4, 5)
14. (a, 3, 4)

HCl

Cl

Ph

O

Cl

O

H

O

S

O

Cl

Ph

O

S

O

Figure 15: Description of Task 10 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

29

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

1. (i, 0, 1)
2. (i, 1, 0)
3. (a, 2, 0)

PH3

+

O

H

P+

H

H

4. (a, 1, 3)

O-

H H

P O

H

5. (i, 0, 1)
6. (i, 2, 1)

+

H3P

O

Figure 16: Description of Task 11 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

30

a

Possible elementary electron moves for given transformation

Selected State/Action Space: 5 Alternatives + Ground Truth

b

Taken  elementary electron moves

Most likely actions taken guided by LLM scoring

c

High level reaction mechanism

Common organic chemistry mechanism interpretaton

1. (i, 1, 2)
2. (i, 2, 0)
3. (a, 3, 4)
4. (a, 3, 2)

5. (i, 2, 3)
6. (a, 1, 2)
7. (i, 0, 1)
4. (a, 4, 0)

O+

O

O

O

O

O

O

O

O

Figure 17: Description of Task 12 in the mechanistic benchmark. a shows the ground truth path
(highlighted in white) along 5 other options for each step (light grey). Dark grey indicates moves
that are part of the ground truth sequence but have already been traversed, serving as a check against
loops in the prediction model. b Shows the isolated ground truth mechanism of the reaction.

31

References

[1] Corey, E. J. & Chelg, X.-M. The Logic of Chemical Synthesis (John Wiley & Sons, 1995).

[2] Gajewska, E. P. et al. Algorithmic Discovery of Tactical Combinations for Advanced Organic
Syntheses. Chem 6, 280–293 (2020). URL https://www.sciencedirect.com/science/
article/pii/S2451929419305261.

[3] Schelhaas, M. & Waldmann, H. Protecting group strategies in organic synthesis. Angewandte

Chemie International Edition 35, 2056–2083 (1996).

[4] Hardy, M. A., Nan, B., Wiest, O. & Sarpong, R. Strategic elements in computer-assisted
retrosynthesis: A case study of the pupukeanane natural products. Tetrahedron 104, 132584
(2022).

[5] Latendresse, M. et al. Synroute: A retrosynthetic planning software. Journal of Chemical

Information and Modeling 63, 5484–5495 (2023).

[6] Gromek, S. M. et al. Synthesis and biological evaluation of santacruzamate a analogues for anti-
proliferative and immunomodulatory activity. Bioorganic & medicinal chemistry 24, 5183–5196
(2016).

[7] English, J. et al. Studies in chemotherapy. ix. ureylenebenzene and cyclohexane derivatives as

biotin antagonists1. Journal of the American Chemical Society 67, 295–302 (1945).

[8] Clark, R. L. & Pessolano, A. A. Synthesis of some substituted benzimidazolones. Journal of

the American Chemical Society 80, 1657–1662 (1958).

[9] Wei, J. et al. Emergent abilities of large language models. arXiv preprint arXiv:2206.07682

(2022).

[10] Brown, T. et al. Language models are few-shot learners. Advances in neural information

processing systems 33, 1877–1901 (2020).

[11] Kaplan, J. et al. Scaling laws for neural language models. arXiv preprint arXiv:2001.08361

(2020).

[12] Lewkowycz, A. et al. Solving quantitative reasoning problems with language models. Advances

in Neural Information Processing Systems 35, 3843–3857 (2022).

[13] Chen, M. et al. Evaluating large language models trained on code.

arXiv preprint

arXiv:2107.03374 (2021).

[14] Suzgun, M. et al. Challenging big-bench tasks and whether chain-of-thought can solve them.

arXiv preprint arXiv:2210.09261 (2022).

[15] Roth, B. D. et al.

Inhibitors of cholesterol biosynthesis. 1.trans-6-(2-pyrrol-l-ylethyl)-4-
hydroxypyran-2-ones, a novel series of hmg-coareductase inhibitors. 1. effects of structural
modiﬁcations at the 2- and5-positions of the pyrrole nucleus. Journal of Medicinal Chemistry
33, 21–31 (1990).

[16] Butler, D. E., Le, T. V. & Nanninga, T. N. Process for trans-6-[2-(substituted-pyrrol-1-

yl)alkyl]pyran-2-one inhibitors of cholesterol synthesis. US Pat. US5298627A (1993).

[17] Cannon, J. S. & Overman, L. E. Is There No End to the Total Syntheses of Strychnine? Lessons
Learned in Strategy and Tactics in Total Synthesis. Angewandte Chemie International Edition
51, 4288–4311 (2012). URL https://onlinelibrary.wiley.com/doi/abs/10.1002/
anie.201107385. _eprint: https://onlinelibrary.wiley.com/doi/pdf/10.1002/anie.201107385.

[18] Genheden, S., Engkvist, O. & Bjerrum, E. Clustering of synthetic routes using tree edit distance.

Journal of Chemical Information and Modeling 61, 3899–3907 (2021).

[19] Genheden, S. & Shields, J. D. A simple similarity metric for comparing synthetic routes. Digital

Discovery (2025).

[20] The 2025 AI Index Report | Stanford HAI. URL https://hai.stanford.edu/ai-index/

2025-ai-index-report.

32

